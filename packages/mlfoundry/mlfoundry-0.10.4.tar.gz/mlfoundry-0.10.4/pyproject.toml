[tool.poetry]
name = "mlfoundry"
version = "0.10.4" # do not change, auto-generated by poetry-dynamic-versioning
description = "Truefoundry's Experiment Tracking, Model Registry and Model Monitoring Library"
authors = ["Abhishek Choudhary <abhichoudhary06@gmail.com>"]
homepage = "https://truefoundry.com"
repository = "https://github.com/truefoundry/mlfoundry"
readme = "README.md"
packages = [
    { include = "mlfoundry" },
]

[tool.poetry.dependencies]
# Note: Do not use ^ or ~. They can cause unecessary confusion
# TODO (chiragjn): Ideally no upper limit should be put on packages because that makes
#    upgrading impossible for users, even if they only want partial compatible features
python = ">=3.7,<4"
GitPython = ">=3.1.35,<4.0.0"
amplitude-tracker = "0.0.7"
click = ">=8.0.0,<9.0.0"
coolname = ">=1.1.0,<2.0.0"
filelock = ">=3.8.0,<4.0.0"
numpy = ">=1.17.0,<2.0.0"
pandas = [
    # This is split into two because poetry will select a version which has no wheel on python >= 3.10 :/
    { version = ">=1.0.0,<3.0.0", python = "<3.10" },
    { version = ">=1.4.0,<3.0.0", python = ">=3.10" },
]
psutil = ">=5.9.0,<6.0.0"
pydantic = ">=1.8.2,<2.0.0"
scikit-learn = ">=0.24.2,<2.0.0"
scipy = [
    # This is split into two because poetry will select a version which has no wheel on python >= 3.10 :/
    { version = ">=1.5.4,<2.0.0", python = "<3.10" },
    { version = ">=1.8.0,<2.0.0", python = ">=3.10" },
]
tfy-mlflow-client = "0.0.41"
tqdm = ">=4.62.3,<5.0.0"
urllib3 = ">=1.26.18,<3"
# Check and try to eliminate libs below this comment
importlib-metadata = ">=4.11.3,<7.0.0"
packaging = ">=20.0,<24.0"

[tool.poetry.dev-dependencies]
pre-commit = "2.21.0"
pytest = ">=7.2.0,<7.3.0"
Pillow = ">=9.1.1,<11.0.0"
doq = ">=0.9.1,<1.0.0"
ipython = ">=7.10.0"
ipykernel = ">=6.16.0"
lazydocs = ">=0.4.8,<0.5.0"
matplotlib = ">=3.0.0,<4.0.0"
mypy = ">=0.950"
plotly = ">=5.8.2"
shap = ">=0.40.0"
# TODO (chiragjn): As of 27th March, 2023 `tensorflow-io-gcs-filesystem` has upper limit 3.11
#   Adding python version limits us to running specific tests Python < 3.12
tensorflow-io-gcs-filesystem = [
    { version = "<0.32", platform = "win32", python = "<3.12"  },
]
# TODO (chiragjn): Adding tensorflow-macos>=2.11.0 can make running tests on M1 macs possible
#   but poetry seems to lock numpy to 1.21 which is not compatible, will need numpy >= 1.23
tensorflow = [
    # This is split into two because poetry will select a version which has no wheel on python 3.7 :/
    { version = ">=2.9.3,<2.11.0", python = "<3.8" },
    { version = ">=2.11.1,<3.0.0", python = ">=3.8,<3.12" }
]
tensorflow-intel = [
    # This is split into two because poetry will select a version which has no wheel on python 3.7 :/
    { version = ">=2.9.3,<2.11.0", platform = "win32", python = "<3.8" },
    { version = ">=2.11.1,<3.0.0", platform = "win32", python = ">=3.8,<3.12" }
]
torch = ">=1.9.0,<2.0.0"
torchvision = ">=0.10.0"
transformers = ">=4.19.2,<5.0.0"

[tool.poetry-dynamic-versioning]
enable = false

[tool.poetry.plugins."console_scripts"]
mlfoundry = "mlfoundry.cli.cli_interface:create_mlfoundry_cli"

[tool.black]
line-length = 88
safe = true
target_version = ["py36", "py37", "py38", "py39", "py310"]

[tool.isort]
profile = "black"

[build-system]
requires = ["poetry-core>=1.0.0", "poetry-dynamic-versioning"]
build-backend = "poetry.core.masonry.api"

[tool.pytest.ini_options]
markers = [
    "uses_tf: marks tests that import and use tensorflow"
]
