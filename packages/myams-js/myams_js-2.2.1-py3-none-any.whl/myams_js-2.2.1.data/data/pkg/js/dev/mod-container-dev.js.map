{"version":3,"file":"mod-container-dev.js","names":["$","MyAMS","container","_exports","switchElementAttribute","action","link","params","require","then","cell","parents","first","icon","row","table","col","index","location","data","updateTarget","objectName","hint","attr","tooltip","replaceWith","ajax","post","object_name","attribute_name","result","status","xhr","state","addClass","handle_json","handleJSON","deleteElement","alert","bigBox","title","i18n","WARNING","message","CONFIRM_REMOVE","successLabel","CONFIRM","cancelLabel","BTN_CANCEL","deleteTarget","hasClass","DataTable","remove","draw","window","env","bundle","config","modules","push","console","debug"],"sources":["mod-container.js"],"sourcesContent":["/* global MyAMS */\n/**\n * MyAMS container management\n */\n\nconst $ = MyAMS.$;\n\n\nexport const container = {\n\n\t/**\n\t * Switch attribute of container element\n\t *\n\t * @param action\n\t */\n\tswitchElementAttribute: (action) => {\n\t\treturn function(link, params) {\n\t\t\tMyAMS.require('ajax', 'alert', 'i18n').then(() => {\n\t\t\t\tconst\n\t\t\t\t\tcell = link.parents('td').first(),\n\t\t\t\t\ticon = $('i', cell),\n\t\t\t\t\trow = cell.parents('tr'),\n\t\t\t\t\ttable = row.parents('table'),\n\t\t\t\t\tcol = $(`thead th:nth-child(${cell.index()+1})`, table);\n\t\t\t\tlet location = link.data('ams-location') || col.data('ams-location') ||\n\t\t\t\t\trow.data('ams-location') || table.data('ams-location') || '';\n\t\t\t\tif (location) {\n\t\t\t\t\tlocation += '/';\n\t\t\t\t}\n\t\t\t\tconst\n\t\t\t\t\tupdateTarget = link.data('ams-update-target') || col.data('ams-update-target') ||\n\t\t\t\t\t\trow.data('ams-update-target') || table.data('ams-update-target') ||\n\t\t\t\t\t\t'switch-element-attribute.json',\n\t\t\t\t\tobjectName = row.data('ams-element-name'),\n\t\t\t\t\thint = icon.attr('data-original-title') || icon.attr('title');\n\t\t\t\ticon.tooltip('hide')\n\t\t\t\t\t.replaceWith('<i class=\"fas fa-spinner fa-spin\"></i>');\n\t\t\t\tMyAMS.ajax.post(location + updateTarget, {\n\t\t\t\t\tobject_name: objectName,\n\t\t\t\t\tattribute_name: col.data('ams-attribute-name')\n\t\t\t\t}).then((result, status, xhr) => {\n\t\t\t\t\tlet icon = $('i', cell);\n\t\t\t\t\tif (result.status === 'success') {\n\t\t\t\t\t\tif (result.state) {\n\t\t\t\t\t\t\ticon.replaceWith(`<i class=\"${col.data('ams-icon-on')}\"></i>`);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ticon.replaceWith(`<i class=\"${col.data('ams-icon-off')}\"></i>`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (hint) {\n\t\t\t\t\t\t\ticon = $('i', cell);\n\t\t\t\t\t\t\ticon.addClass('hint')\n\t\t\t\t\t\t\t\t.attr('data-original-title', hint);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (result.handle_json) {\n\t\t\t\t\t\t\tMyAMS.ajax.handleJSON(result);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tMyAMS.ajax.handleJSON(result);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t},\n\n\t/**\n\t * Delete element from container\n\t *\n\t * @param action\n\t * @returns {(function(*, *): void)|*}\n\t */\n\tdeleteElement: (action) => {\n\t\treturn function(link, params) {\n\t\t\tMyAMS.require('ajax', 'alert', 'i18n').then(() => {\n\t\t\t\tMyAMS.alert.bigBox({\n\t\t\t\t\tstatus: 'danger',\n\t\t\t\t\ticon: 'fas fa-bell',\n\t\t\t\t\ttitle: MyAMS.i18n.WARNING,\n\t\t\t\t\tmessage: MyAMS.i18n.CONFIRM_REMOVE,\n\t\t\t\t\tsuccessLabel: MyAMS.i18n.CONFIRM,\n\t\t\t\t\tcancelLabel: MyAMS.i18n.BTN_CANCEL\n\t\t\t\t}).then((status) => {\n\t\t\t\t\tif (status !== 'success') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst\n\t\t\t\t\t\tcell = link.parents('td'),\n\t\t\t\t\t\trow = cell.parents('tr'),\n\t\t\t\t\t\ttable = row.parents('table'),\n\t\t\t\t\t\tcol = $(`thead th:nth-child(${cell.index()+1})`, table);\n\t\t\t\t\tlet location = link.data('ams-location') ||  col.data('ams-location') ||\n\t\t\t\t\t\trow.data('ams-location') || table.data('ams-location') || '';\n\t\t\t\t\tif (location) {\n\t\t\t\t\t\tlocation += '/';\n\t\t\t\t\t}\n\t\t\t\t\tconst\n\t\t\t\t\t\tdeleteTarget = link.data('ams-delete-target') || col.data('ams-delete-target') ||\n\t\t\t\t\t\t\trow.data('ams-delete-target') || table.data('ams-delete-target') ||\n\t\t\t\t\t\t\t'delete-element.json',\n\t\t\t\t\t\tobjectName = row.data('ams-element-name');\n\t\t\t\t\tMyAMS.ajax.post(location + deleteTarget, {\n\t\t\t\t\t\t'object_name': objectName\n\t\t\t\t\t}).then((result, status, xhr) => {\n\t\t\t\t\t\tif (result.status === 'success') {\n\t\t\t\t\t\t\tif (table.hasClass('datatable')) {\n\t\t\t\t\t\t\t\ttable.DataTable().row(row).remove().draw();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trow.remove();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (result.handle_json) {\n\t\t\t\t\t\t\t\tMyAMS.ajax.handleJSON(result);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tMyAMS.ajax.handleJSON(result);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\t}\n};\n\n\n/**\n * Global module initialization\n */\nif (window.MyAMS) {\n\tif (MyAMS.env.bundle) {\n\t\tMyAMS.config.modules.push('container');\n\t} else {\n\t\tMyAMS.container = container;\n\t\tconsole.debug(\"MyAMS: container module loaded...\");\n\t}\n}\n"],"mappings":"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"}