//>>built
define("dstore/SimpleQuery",["dojo/_base/declare","dojo/_base/array"],function(m,g){function p(a,b){if(-1<a.indexOf(".")){var d=a.split("."),e=d.length;return function(a){for(var c=0;c<e;c++)a=a&&(b&&a.get?a.get(d[c]):a[d[c]]);return a}}return function(b){return b.get?b.get(a):b[a]}}var r={eq:function(a,b){return a===b},"in":function(a,b){return-1<g.indexOf(b.data||b,a)},ne:function(a,b){return a!==b},lt:function(a,b){return a<b},lte:function(a,b){return a<=b},gt:function(a,b){return a>b},gte:function(a,
b){return a>=b},match:function(a,b,d){return b.test(a,d)},contains:function(a,b,d,e){var h=this;b=b.data?b.data:Array.isArray(b)?b:[b];return g.every(b,function(b){if("object"===typeof b&&b.type){var c=h._getFilterComparator(b.type);return g.some(a,function(a){return c.call(h,a,b.args[1],d,e)})}return-1<g.indexOf(a,b)})}};return m(null,{_createFilterQuerier:function(a){function b(a){var c=a.type;a=a.args;var f=e._getFilterComparator(c);if(f){var h=a[0],g=p(h,d),l=a[1];l&&l.fetchSync&&(l=l.fetchSync());
return function(a){return f.call(e,g(a),l,a,h)}}switch(c){case "and":case "or":for(var n=0,m=a.length;n<m;n++){var q=b(a[n]);var k=k?function(a,b){return"and"===c?function(c){return a(c)&&b(c)}:function(c){return a(c)||b(c)}}(k,q):q}return k;case "function":return a[0];case "string":k=e[a[0]];if(!k)throw Error("No filter function "+a[0]+" was found in the collection");return k;case void 0:return function(){return!0};default:throw Error('Unknown filter operation "'+c+'"');}}var d=this.queryAccessors,
e=this,h=b(a);return function(a){return g.filter(a,h)}},_getFilterComparator:function(a){return r[a]||this.inherited(arguments)},_createSelectQuerier:function(a){return function(b){var d=a.length;return g.map(b,a instanceof Array?function(b){for(var h={},c=0;c<d;c++){var e=a[c];h[e]=b[e]}return h}:function(b){return b[a]})}},_createSortQuerier:function(a){var b=this.queryAccessors;return function(d){d=d.slice();d.sort("function"==typeof a?a:function(d,h){for(var c=0;c<a.length;c++){var e=a[c];if("function"==
typeof e)var f=e(d,h);else{f=e.get||(e.get=p(e.property,b));e=e.descending;var g=f(d);f=f(h);null!=g&&(g=g.valueOf());null!=f&&(f=f.valueOf());f=g===f?0:!!e===("undefined"===typeof f||null===f&&"undefined"!==typeof g||null!=g&&g<f)?1:-1}if(0!==f)return f}return 0});return d}}})});
//# sourceMappingURL=SimpleQuery.js.map