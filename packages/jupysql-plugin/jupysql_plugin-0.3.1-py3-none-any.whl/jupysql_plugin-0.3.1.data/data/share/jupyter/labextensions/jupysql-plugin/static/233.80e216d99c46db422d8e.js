(self.webpackChunkjupysql_plugin=self.webpackChunkjupysql_plugin||[]).push([[233],{5233:(e,t,n)=>{"use strict";n.r(t),n.d(t,{MODULE_NAME:()=>J,MODULE_VERSION:()=>z,default:()=>le});var o={};n.r(o),n.d(o,{FormModel:()=>K,FormView:()=>Y});var i={};n.r(i),n.d(i,{TableModel:()=>X,TableView:()=>ee});var l={};n.r(l),n.d(l,{ConnectorModel:()=>ne,ConnectorView:()=>oe});var s=n(7423),a=n(2877),r=n(2297);class c{constructor(e,t,n){var o,i;this.app=e,this.tracker=t,this.code_mirror=n,null===(i=null===(o=this.tracker)||void 0===o?void 0:o.activeCellChanged)||void 0===i||i.connect((()=>{var e;if(null!==(null===(e=this.tracker)||void 0===e?void 0:e.activeCell)){const e=this.tracker.activeCell;if(null!==e&&"code"===(null==e?void 0:e.model.type)){const t=null==e?void 0:e.editor,n=r.debounce((()=>{var e;const n=null===(e=t.getLine(t.firstLine()))||void 0===e?void 0:e.trim();(null==n?void 0:n.startsWith("%%sql"))?t.editor.setOption("mode","text/x-sql"):t.editor.setOption("mode","text/x-ipython")}),300);t.editor.on("change",n),n()}}}))}}const d={id:"@ploomber/sql-syntax-highlighting",autoStart:!0,requires:[s.INotebookTracker,a.ICodeMirror],optional:[],activate:function(e,t,n){new c(e,t,n),console.log("SQLCodeMirror loaded.")}};var u,m=n(9965),p=n(3071);class h extends p.DataConnector{constructor(e){super(),this._connectors=e}fetch(e){return Promise.all(this._connectors.map((t=>t.fetch(e)))).then((e=>{const t=e.filter((e=>!!e));return u.mergeReplies(t)}))}}!function(e){e.mergeReplies=function(e){const t=e.filter((e=>e.matches.length>0));if(0===t.length)return e[0];if(1===t.length)return t[0];const n=new Set;return t.forEach((e=>{e.matches.forEach((e=>n.add(e)))})),{...t[0],matches:[...n]}}}(u||(u={}));const v=JSON.parse('{"H":[{"value":"ADD"},{"value":"ADD CONSTRAINT"},{"value":"ALL"},{"value":"ALTER"},{"value":"ALTER COLUMN"},{"value":"ALTER TABLE"},{"value":"AND"},{"value":"ANY"},{"value":"AS"},{"value":"ASC"},{"value":"BACKUP DATABASE"},{"value":"BETWEEN"},{"value":"CASE"},{"value":"CHECK"},{"value":"COLUMN"},{"value":"CONSTRAINT"},{"value":"CREATE"},{"value":"CREATE DATABASE"},{"value":"CREATE INDEX"},{"value":"CREATE OR REPLACE VIEW"},{"value":"CREATE TABLE"},{"value":"CREATE PROCEDURE"},{"value":"CREATE UNIQUE INDEX"},{"value":"CREATE VIEW"},{"value":"DATABASE"},{"value":"DEFAULT"},{"value":"DELETE"},{"value":"DESC"},{"value":"DISTINCT"},{"value":"DROP"},{"value":"DROP COLUMN"},{"value":"DROP CONSTRAINT"},{"value":"DROP DATABASE"},{"value":"DROP DEFAULT"},{"value":"DROP INDEX"},{"value":"DROP TABLE"},{"value":"DROP VIEW"},{"value":"EXEC"},{"value":"EXISTS"},{"value":"FOREIGN KEY"},{"value":"FROM"},{"value":"FULL OUTER JOIN"},{"value":"GROUP BY"},{"value":"HAVING"},{"value":"IN"},{"value":"INDEX"},{"value":"INNER JOIN"},{"value":"INSERT INTO"},{"value":"INSERT INTO SELECT"},{"value":"IS NULL"},{"value":"IS NOT NULL"},{"value":"JOIN"},{"value":"LEFT JOIN"},{"value":"LIKE"},{"value":"LIMIT"},{"value":"NOT"},{"value":"NOT NULL"},{"value":"OR"},{"value":"ORDER BY"},{"value":"OUTER JOIN"},{"value":"PRIMARY KEY"},{"value":"PROCEDURE"},{"value":"RIGHT JOIN"},{"value":"ROWNUM"},{"value":"SELECT"},{"value":"SELECT DISTINCT"},{"value":"SELECT INTO"},{"value":"SELECT TOP"},{"value":"SET"},{"value":"TABLE"},{"value":"TOP"},{"value":"TRUNCATE TABLE"},{"value":"UNION"},{"value":"UNION ALL"},{"value":"UNIQUE"},{"value":"UPDATE"},{"value":"VALUES"},{"value":"VIEW"},{"value":"WHERE"}]}');class g extends p.DataConnector{constructor(e){super(),this._editor=e.editor,this._sessionContext=e.sessionContext}fetch(e){return this._editor?new Promise((e=>{e(b.completionHint(this._editor,this._sessionContext))})):Promise.reject("No editor")}}var b,y;!function(e){e.completionHint=function(e,t){const n=e.getCursorPosition(),o=e.getTokenForPosition(n),i=v.H.filter((e=>e.value.startsWith(o.value.toUpperCase()))).map((e=>e.value)),l=Array.from(new Set(i));return{start:o.offset,end:o.offset+o.value.length,matches:l,metadata:{}}}}(b||(b={})),function(e){e.invoke="completer:invoke",e.invokeNotebook="completer:invoke-notebook",e.select="completer:select",e.selectNotebook="completer:select-notebook"}(y||(y={}));const C={id:"completer",autoStart:!0,requires:[m.ICompletionManager,s.INotebookTracker],activate:async(e,t,n)=>{console.log("JupyterLab extension jupysql-plugin is activated!"),n.widgetAdded.connect(((e,n)=>{var o,i;let l=null!==(i=null===(o=n.content.activeCell)||void 0===o?void 0:o.editor)&&void 0!==i?i:null;const s=n.sessionContext.session,a=n.sessionContext,r={session:s,editor:l,sessionContext:a},c=new h([]),d=t.register({connector:c,editor:l,parent:n}),u=()=>{var e,t;l=null!==(t=null===(e=n.content.activeCell)||void 0===e?void 0:e.editor)&&void 0!==t?t:null,r.session=n.sessionContext.session,r.sessionContext=n.sessionContext,r.editor=l,d.editor=l;const o=new m.KernelConnector(r),i=new m.ContextConnector(r),s=new g(r);d.connector=new h([o,i,s])};n.content.activeCellChanged.connect(u),n.sessionContext.sessionChanged.connect(u)})),e.commands.addCommand(y.invokeNotebook,{execute:()=>{var t;const o=n.currentWidget;if(o&&"code"===(null===(t=o.content.activeCell)||void 0===t?void 0:t.model.type))return e.commands.execute(y.invoke,{id:o.id})}}),e.commands.addCommand(y.selectNotebook,{execute:()=>{const t=n.currentWidget&&n.currentWidget.id;if(t)return e.commands.execute(y.select,{id:t})}}),e.commands.addKeyBinding({command:y.selectNotebook,keys:["Enter"],selector:".jp-Notebook .jp-mod-completer-active"})}};var f=n(5923),w=n(5777),E=n(6560);class k{constructor(e){this.notebookTracker=e}async formatAllCodeCells(e,t,n){return this.formatCells(!1,e,t,n)}getCodeCells(e=!0,t){if(!this.notebookTracker.currentWidget)return[];const n=[];return(t=t||this.notebookTracker.currentWidget.content).widgets.forEach((o=>{"code"===o.model.type&&(e&&!t.isSelectedOrActive(o)||n.push(o))})),n}async formatCells(e,t,n,o){if(!this.working){try{this.working=!0;const t=this.getCodeCells(e,o);if(0===t.length)return void(this.working=!1);for(let e=0;e<t.length;++e){const n=t[e],o=n.model.value.text;if(o.startsWith("%%sql")){const e=o.split("\n"),t=e.shift();try{const o=(0,E.format)(e.join("\n"),{language:"sql",keywordCase:"upper"});n.model.value.text=t+"\n"+o}catch(e){}}}}catch(e){await(0,w.showErrorMessage)("Jupysql plugin formatting",e)}this.working=!1}}applicable(e,t){const n=this.notebookTracker.currentWidget;return n&&t===n}}var _=n(6271),x=n.n(_),S=n(6319),T=n(9418);var N=n(7543),L=n(8957);async function j(e="",t={}){const n=L.ServerConnection.makeSettings(),o=N.URLExt.join(n.baseUrl,"ploomber",e);let i;try{i=await L.ServerConnection.makeRequest(o,t,n)}catch(e){throw new L.ServerConnection.NetworkError(e)}let l=await i.text();if(l.length>0)try{l=JSON.parse(l)}catch(e){console.log("Not a JSON response body.",i)}if(!i.ok)throw new L.ServerConnection.ResponseError(i,l.message||l);return l}const O=e=>{var t,n,o,i,l,s;return"missing file"==(null===(t=null==e?void 0:e.message)||void 0===t?void 0:t.type)?x().createElement("div",{"data-testid":"error-message-area"},x().createElement(S.Typography,{variant:"subtitle1",gutterBottom:!0}," A ",x().createElement("code",null,null===(o=null===(n=null==e?void 0:e.message)||void 0===n?void 0:n.detail)||void 0===o?void 0:o.fileName)," file with dependencies is required to deploy your notebook. Please add it at ",x().createElement("code",null,null===(l=null===(i=null==e?void 0:e.message)||void 0===i?void 0:i.detail)||void 0===l?void 0:l.filePath),". To learn more, see the ",x().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://docs.cloud.ploomber.io/en/latest/apps/jupyterlab-plugin.html"},"docs"))):x().createElement(S.Typography,{variant:"subtitle1",gutterBottom:!0},null===(s=null==e?void 0:e.message)||void 0===s?void 0:s.detail)},I=e=>{const t=e.notebook_path,[n,o]=(0,_.useState)(!0),[i,l]=(0,_.useState)(!1),[s,a]=(0,_.useState)(!1),[r,c]=(0,_.useState)(!1),[d,u]=(0,_.useState)(""),[m,p]=(0,_.useState)(""),[h,v]=(0,_.useState)("init"),[g,b]=(0,_.useState)(null),[y,C]=(0,_.useState)("");(0,_.useEffect)((()=>{f()}),[]),(0,_.useEffect)((()=>{"success"===h&&c(!0)}),[h]);const f=async()=>{await j("apikey").then((e=>{null!=(null==e?void 0:e.data)&&(u(e.data),v("success"))})).catch((e=>{console.error(`The jupyterlab_examples_server server extension appears to be missing.\n${e}`)})),o(!1)},w={init:{label:"API Key",variant:"outlined",color:"primary"},success:{label:"Valid API Key",variant:"filled",color:"success"},error:{label:"Please enter valid API Key",variant:"filled",color:"warning"}};return x().createElement(S.Box,{p:6,style:{width:600}},n||i?x().createElement(S.Box,{sx:{display:"flex",justifyContent:"center",alignItems:"center"}},x().createElement(S.CircularProgress,null)):x().createElement(x().Fragment,null,x().createElement(S.Grid,{container:!0,spacing:4,alignItems:"center",direction:"column"},"success"!==h&&x().createElement("div",null,x().createElement(S.Grid,{item:!0,container:!0,direction:"row",alignItems:"center",justifyContent:"flex-start",width:"100%",my:2},"Upload this notebook to Ploomber Cloud to share it with anyone. ",x().createElement(S.Link,{href:"https://docs.cloud.ploomber.io/en/latest/examples/voila.html",target:"_blank",rel:"noopener noreferrer"}," Click here to learn more.")),x().createElement(S.Grid,{item:!0,container:!0,direction:"row",alignItems:"center",width:"100%"},x().createElement(S.Grid,{container:!0,direction:"row",alignItems:"center",spacing:1},x().createElement(S.Grid,{item:!0,xs:10},x().createElement(S.TextField,{id:"api-key-input",size:"small",onChange:e=>{u(e.target.value)},value:d,label:w[h].label,variant:w[h].variant,color:w[h].color,error:"error"==h,fullWidth:!0,focused:!0})),x().createElement(S.Grid,{item:!0,xs:2,alignItems:"center",justifyContent:"center"},x().createElement(S.Button,{onClick:async()=>{o(!0);const e={api_key:d};await j("apikey",{body:JSON.stringify(e),method:"POST"}).then((e=>{"success"==(null==e?void 0:e.result)?v("success"):v("error")})).catch((t=>{console.error(`Error on POST ${e}.\n${t}`)})),o(!1)},variant:"contained",size:"small"},"CONFIRM")))),x().createElement(S.Grid,{item:!0,container:!0,direction:"row",alignItems:"center",width:"100%",my:2},"You need an API key to upload this notebook.Â ",x().createElement(S.Link,{href:"https://docs.cloud.ploomber.io/en/latest/quickstart/apikey.html",target:"_blank",rel:"noopener noreferrer"},"Click here to get an API Key"))),"success"==h&&x().createElement(S.Grid,{item:!0,container:!0,alignItems:"center",spacing:4,direction:"column"},r?x().createElement(x().Fragment,null,x().createElement(x().Fragment,null,x().createElement(S.Typography,{variant:"subtitle1",gutterBottom:!0},"Confirm that you want to upload this notebook to Ploomber Cloud"),x().createElement(S.Button,{onClick:async()=>{c(!1),await(async()=>{l(!0);const n={notebook_path:t,api_key:d};await j("nb-upload",{body:JSON.stringify(n),method:"POST"}).then((t=>{var n,o,i=t.deployment_result,l={type:"generic",detail:""};"missing file"===(null==i?void 0:i.type)&&(null==i?void 0:i.detail)?(l.type=i.type,l.detail={fileName:"requirements.txt",filePath:i.detail},b(l)):(null==i?void 0:i.detail)||(null==i?void 0:i.message)?(l.detail=i.detail||i.message,b(l)):(p("https://platform.ploomber.io/notebooks/"+(null==i?void 0:i.id)),null===(n=null==e?void 0:e.metadata)||void 0===n||n.set("ploomber",{project_id:null==i?void 0:i.project_id}),null===(o=null==e?void 0:e.context)||void 0===o||o.save())})),l(!1)})()},variant:"contained",size:"small",color:"primary",disabled:""!==m,endIcon:x().createElement(T.Z,null)},"CONFIRM "))):x().createElement(x().Fragment,null,g?x().createElement(O,{message:g}):x().createElement(x().Fragment,null,x().createElement(S.Grid,{item:!0,justifyContent:"center",xs:12},"Your notebook is available here:"),x().createElement(S.Grid,{item:!0,justifyContent:"center",xs:12},x().createElement(S.Chip,{label:m,variant:"outlined",onClick:()=>{window.open(m),a(!0),C("Deployment Success")}}),x().createElement(S.Snackbar,{open:s,onClose:()=>a(!1),autoHideDuration:2e3,message:y}))))))))};class D extends w.ReactWidget{constructor(e){super(),this.state={notebookPath:e.notebookPath,metadata:e.metadata,context:e.context}}render(){return x().createElement(I,{notebook_path:this.state.notebookPath,metadata:this.state.metadata,context:this.state.context})}}var A=n(6201),M=n(1840);const q="jupysql-plugin:settings",B=new M.Signal({}),R={id:q,autoStart:!0,requires:[A.ISettingRegistry],activate:(e,t,n)=>{function o(e){const t=e.get("showDeployNotebook").composite,n=e.get("showFormatSQL").composite;B.emit({showDeployNotebook:t,showFormatSQL:n})}Promise.all([e.restored,t.load(q)]).then((([,e])=>{o(e),e.changed.connect(o)})).catch((e=>{console.error(`Something went wrong when reading the settings.\n${e}`)}))}};class P{constructor(){this._onSettingsChanged=(e,t)=>{t.showDeployNotebook?this.panel.toolbar.insertItem(10,"deployNB",this.deployNotebookButton):this.deployNotebookButton.parent=null},B.connect(this._onSettingsChanged)}createNew(e,t){return this.panel=e,this.deployNotebookButton=new w.ToolbarButton({className:"share-nb-button",label:"Share Notebook",onClick:()=>{!function(e,t){const n=new D({notebookPath:e.context.contentsModel.path,metadata:e.model.metadata,context:t});new w.Dialog({title:"Share Notebook",body:n,buttons:[{label:"Close",caption:"",className:"bg-info",accept:!1,actions:[],displayType:"default",iconClass:"",iconLabel:""}]}).launch()}(e,t)},tooltip:"Share notebook by uploading it to Ploomber Cloud"}),this.deployNotebookButton.node.setAttribute("data-testid","share-btn"),e.toolbar.insertItem(10,"deployNB",this.deployNotebookButton),new f.DisposableDelegate((()=>{this.deployNotebookButton.dispose()}))}}class F{createNew(e,t){return setTimeout((()=>{(e=>{var t;const n=null===(t=e.sessionContext.session)||void 0===t?void 0:t.kernel;n&&document.addEventListener("onUpdateTableWidget",(async e=>{const t=e.detail.data,o=n.createComm("comm_target_handle_table_widget");await o.open("initializing connection").done,o.send(t),o.onMsg=e=>{const t=e.content.data;let n=new CustomEvent("onTableWidgetRowsReady",{bubbles:!0,cancelable:!0,composed:!1,detail:{data:t}});document.body.dispatchEvent(n)}}))})(t)}),5e3),new f.DisposableDelegate((()=>{}))}}class H{constructor(e){this._onSettingsChanged=(e,t)=>{t.showFormatSQL?this.panel.toolbar.insertItem(10,"formatSQL",this.formatSQLButton):this.formatSQLButton.parent=null},this.notebookCodeFormatter=new k(e),B.connect(this._onSettingsChanged)}createNew(e,t){return this.panel=e,this.formatSQLButton=new w.ToolbarButton({className:"format-sql-button",label:"Format SQL",onClick:()=>{this.notebookCodeFormatter.formatAllCodeCells(void 0,void 0,e.content)},tooltip:"Format all %%sql cells"}),this.formatSQLButton.node.setAttribute("data-testid","format-btn"),e.toolbar.insertItem(10,"formatSQL",this.formatSQLButton),new f.DisposableDelegate((()=>{this.formatSQLButton.dispose()}))}}const U={activate:(e,t)=>{e.docRegistry.addWidgetExtension("Notebook",new H(t)),e.docRegistry.addWidgetExtension("Notebook",new P),e.docRegistry.addWidgetExtension("Notebook",new F)},autoStart:!0,id:"formatting",requires:[s.INotebookTracker]};var W=n(8947);const V=n(4147),z=V.version,J=V.name;var $=n(3379),G=n.n($),Q=n(7517);G()(Q.Z,{insert:"head",singleton:!1}),Q.Z.locals;class K extends W.DOMWidgetModel{defaults(){return{...super.defaults(),_model_name:K.model_name,_model_module:K.model_module,_model_module_version:K.model_module_version,_view_name:K.view_name,_view_module:K.view_module,_view_module_version:K.view_module_version,value:"Hello World"}}}K.serializers={...W.DOMWidgetModel.serializers},K.model_name="FormModel",K.model_module=J,K.model_module_version=z,K.view_name="FormView",K.view_module=J,K.view_module_version=z;class Y extends W.DOMWidgetView{render(){this.el.classList.add("custom-widget"),this.el.innerHTML='\n        <form id="myForm">\n        <label for="protocol">Select a protocol:</label>\n        <select id="protocol" name="protocol">\n          <option value="HTTP">HTTP</option>\n          <option value="HTTPS">HTTPS</option>\n        </select>\n      \n        <label for="port">Enter a port:</label>\n        <input type="number" id="port" name="port">\n\n        <div id="confirmationMessage"></div>\n      \n        <button type="submit">Submit</button>\n      </form>\n      \n',this.el.querySelector("#myForm").addEventListener("submit",this.handleFormSubmit.bind(this)),this.model.on("msg:custom",this.handleMessage.bind(this))}handleFormSubmit(e){e.preventDefault();const t=e.target,n=new FormData(t),o={};for(const[e,t]of n.entries())o[e]=t.toString();this.sendFormData(o)}sendFormData(e){const t={method:"submit_form",data:e};this.send(t)}handleMessage(e){if("display_confirmation_message"===e.method){const t=this.el.querySelector("#confirmationMessage");t&&(t.textContent=e.message)}}}n(4039);var Z=n(9982);class X extends W.DOMWidgetModel{defaults(){return{...super.defaults(),_model_name:X.model_name,_model_module:X.model_module,_model_module_version:X.model_module_version,_view_name:X.view_name,_view_module:X.view_module,_view_module_version:X.view_module_version,value:"Hello World"}}}X.serializers={...W.DOMWidgetModel.serializers},X.model_name="TableModel",X.model_module=J,X.model_module_version=z,X.view_name="TableView",X.view_module=J,X.view_module_version=z;class ee extends W.DOMWidgetView{render(){const e=[{symbol:"AAPL",price:142.34,change:1.25},{symbol:"GOOGL",price:2725.45,change:-4.56},{symbol:"MSFT",price:259.43,change:2.78},{symbol:"AMZN",price:3310.98,change:-7.92}];this.el.innerHTML=`\n      <table class="table">\n        <thead>\n          <tr>\n            <th data-bs-toggle="tooltip" data-bs-placement="top" title="symbol">Symbol</th>\n            <th data-bs-toggle="tooltip" data-bs-placement="top" title="price">Price</th>\n            <th data-bs-toggle="tooltip" data-bs-placement="top" title="change">Change</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${e.map((e=>`\n            <tr>\n              <td>${e.symbol}</td>\n              <td>${e.price}</td>\n              <td>${e.change}</td>\n            </tr>\n          `)).join("")}\n        </tbody>\n      </table>\n    `,Array.from(this.el.querySelectorAll('[data-bs-toggle="tooltip"]')).forEach((t=>{const n=t.getAttribute("title"),o=e.map((e=>e[n])).join(", ");new Z.Tooltip(t,{title:o})}))}}var te=n(9889);G()(te.Z,{insert:"head",singleton:!1}),te.Z.locals;class ne extends W.DOMWidgetModel{defaults(){return{...super.defaults(),_model_name:ne.model_name,_model_module:ne.model_module,_model_module_version:ne.model_module_version,_view_name:ne.view_name,_view_module:ne.view_module,_view_module_version:ne.view_module_version,connections:ne.connections,connections_templates:ne.connections_templates,driver_to_dbname:ne.driver_to_dbname}}}ne.serializers={...W.DOMWidgetModel.serializers},ne.model_name="ConnectorModel",ne.model_module=J,ne.model_module_version=z,ne.view_name="ConnectorModel",ne.view_module=J,ne.view_module_version=z,ne.connections=[],ne.connections_templates=[],ne.driver_to_dbname=[];class oe extends W.DOMWidgetView{constructor(){super(...arguments),this.connections=JSON.parse(this.model.get("connections")),this.connectionsTemplates=JSON.parse(this.model.get("connections_templates")),this.driver_to_dbname=this.model.get("driver_to_dbname"),this.activeConnection=""}render(){this.el.classList.add("connector-widget"),this.drawConnectionsList(this.connections),this.model.on("msg:custom",this.handleMessage.bind(this))}drawConnectionsList(e){console.log("driver to db name",this.driver_to_dbname),this.el.innerHTML="",this.el.innerHTML='\n        <div id="connectionsManager">\n            <div id="connectionsContainer" class="block">\n                <h3>\n                    Connections\n                </h3>\n\n                <div class="connections-guidelines block">\n                    <i>\n                        * Connections are loaded from your connections file (set it with <code>%config SqlMagic.dsn_filename = "path/to/file", default is "~/.jupysql/connections.ini"</code>).\n                    </i>\n\n                    <i class="no-config-file" style = "display: none;">\n                        * No connections file found. You may need to restart the kernel.\n                    </i>\n\n                    <i class="restart-kernel" style = "display: none;">\n                        * No connections found in connections file. You may need to restart the kernel.\n                    </i>\n                </div>\n\n                <div id="connectionsButtonsContainer" class="block">\n                </div>\n\n                <div class="block">\n                    <div class="create-new-connection" id="createNewConnectionButton">\n                        <div class="icon"></div>\n                        <div id="createNewConnection">\n                            Create new connection\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div class="user-error-message lm-Widget p-Widget lm-Panel p-Panel jp-OutputArea-child" style = "display: none">\n            <div class="lm-Widget jp-RenderedText" data-mime-type="application/vnd.jupyter.stderr">\n            <pre></pre>\n            </div>\n            </div>\n\n\n            <div id="newConnectionContainer" class="block" style = "display: none">\n                <h3 id="connectionFormHeader"></h3>\n                <div class="block">\n                    <select id="selectConnection"></select>\n\n                    <div id="connectionFormContainer">\n                    </div>\n                </div>\n            </div>\n        </div>\n        ',e.forEach((e=>{const{name:t}=e,n=t.replace(/ /g,"_"),o=document.createElement("DIV");o.className="connection-button-container";const i=document.createElement("DIV");i.className="connection-button-actions";const l=document.createElement("DIV");l.className="connection-name",l.innerText=t,i.appendChild(l);const s=document.createElement("BUTTON");s.id=`connBtn_${n}`,s.className="secondary connectionStatusButton",s.innerHTML="Connect",s.onclick=this.handleConnectionClick.bind(this,e);const a=document.createElement("BUTTON");a.className="edit-connection-button",a.id=`editConnBtn_${n}`,a.onclick=this.handleEditConnectionClick.bind(this,e);const r=document.createElement("BUTTON");r.className="delete-connection-button",r.id=`deleteConnBtn_${n}`,r.onclick=this.handleDeleteConnectionClick.bind(this,e);let c=this.el.querySelector("#connectionsButtonsContainer");i.appendChild(s),i.appendChild(a),i.appendChild(r),o.appendChild(i),c.appendChild(o);let d=document.createElement("HR");d.className="divider",o.appendChild(d)}));const t=this.el.querySelector("#selectConnection");Object.keys(this.connectionsTemplates).forEach((e=>{const n=document.createElement("OPTION");n.innerHTML=e,t.appendChild(n)})),t.addEventListener("change",this.handleCreateNewConnectionChange.bind(this)),this.el.querySelector("#createNewConnectionButton").addEventListener("click",this.handleCreateNewConnectionClick.bind(this)),this.activeConnection&&this.markConnectedButton(this.activeConnection),setTimeout((()=>{this.send({method:"check_config_file"})}),500)}handleConnectionClick(e){const t={method:"connect",data:e};this.send(t)}deleteConnection(e){const t={method:"delete_connection",data:e};this.send(t)}handleEditConnectionClick(e){this.el.querySelector("#connectionFormHeader").innerHTML="Edit connection",this.el.querySelector("#connectionsContainer").style.display="none",this.el.querySelector("#newConnectionContainer").style.display="block";const t=this.el.querySelector("#selectConnection"),n=this.driver_to_dbname[e.driver];for(let e=0;e<t.options.length;e++)if(t.options[e].value===n){t.selectedIndex=e;break}const o=this.el.querySelector("#selectConnection").value,i=this.connectionsTemplates[o];this.drawConnectionDetailsForm(i,e.name);const l=this.el.querySelector("#connectionName");l&&(l.value=e.name);const s=this.el.querySelector("#username");s&&(s.value=e.username);const a=this.el.querySelector("#password");a&&(a.value=e.password);const r=this.el.querySelector("#host");r&&(r.value=e.host);const c=this.el.querySelector("#database");c&&(c.value=e.database);const d=this.el.querySelector("#port");d&&(d.value=e.port)}handleDeleteConnectionClick(e){this.hideDeleteMessageApproval();const t=document.createElement("DIV");t.id="deleteConnectionMessage";const n=`<h4>Delete ${e.name} from ini file</h4>\n        <div>Please note that by doing so, you will permanently remove <strong>${e.name}</strong> from the ini file.<div>\n        <div>Are you sure?</div>\n        `;t.innerHTML=`${n} <div class='actions' style = 'margin-top: 20px; display: inline-flex'></div>`;const o=document.createElement("BUTTON");o.innerHTML="Cancel",o.addEventListener("click",this.hideDeleteMessageApproval.bind(this)),t.querySelector(".actions").appendChild(o);const i=document.createElement("BUTTON");i.innerHTML="Delete",i.className="danger",i.id="deleteConnectionButton",i.addEventListener("click",this.deleteConnection.bind(this,e)),t.querySelector(".actions").appendChild(i);const l=this.el.querySelector(`#deleteConnBtn_${e.name.replace(/ /g,"_")}`).parentNode;l.style.display="none",l.parentNode.prepend(t)}hideDeleteMessageApproval(){var e;null===(e=this.el.querySelector("#deleteConnectionMessage"))||void 0===e||e.remove(),this.el.querySelectorAll(".connection-button-actions").forEach((e=>e.style.display="inline-flex"))}handleCreateNewConnectionClick(){this.el.querySelector("#connectionFormHeader").innerHTML="Create new connection",this.el.querySelector("#connectionsContainer").style.display="none",this.el.querySelector("#newConnectionContainer").style.display="block",this.handleCreateNewConnectionChange()}handleCreateNewConnectionChange(){const e=this.el.querySelector("#selectConnection").value,t=this.connectionsTemplates[e],n={},o=sessionStorage.getItem("selectConnection");if(o){const e=this.connectionsTemplates[o],{fields:t}=e;t.forEach((e=>{const t=e.id,o=e.hasOwnProperty("default")?e.default:"",i=this.el.querySelector(`#${t}`);i&&i.value!=o&&(n[t]=i.value)}))}sessionStorage.setItem("fieldInputs",JSON.stringify(n)),sessionStorage.setItem("selectConnection",e),this.drawConnectionDetailsForm(t)}drawConnectionDetailsForm(e,t=""){const{fields:n}=e,o=JSON.parse(sessionStorage.getItem("fieldInputs")),i=this.el.querySelector("#connectionFormContainer");i.innerHTML="";const l=document.createElement("FORM");l.id="connectionForm",i.appendChild(l);const s=document.createElement("input");s.type="hidden",s.name="existingConnectionAlias",s.value=t||"",l.appendChild(s),n.forEach((e=>{const t=document.createElement("DIV");t.className="field-container";const n=document.createElement("LABEL");n.setAttribute("for",e.id),n.innerHTML=e.label;const i=document.createElement("INPUT");i.id=e.id,i.name=e.id,i.className="field";const s=o&&o[e.id]||"";"connectionName"==e.id&&0===this.connections.length?i.value=s||"default":s?i.value=s:void 0!==e.default&&(i.value=e.default),i.setAttribute("type",e.type),t.appendChild(n),t.appendChild(i),l.appendChild(t)}));const a=document.createElement("DIV");a.className="buttons-container";const r=document.createElement("BUTTON");r.innerHTML="Cancel",r.className="secondary",r.addEventListener("click",this.drawConnectionsList.bind(this,this.connections)),a.appendChild(r);const c=document.createElement("BUTTON");c.className="primary",a.appendChild(c),t?(c.innerHTML="Update",c.id="updateConnectionFormButton",l.addEventListener("submit",this.handleSubmitNewConnection.bind(this))):(c.innerHTML="Create",c.id="createConnectionFormButton",l.addEventListener("submit",this.handleSubmitNewConnection.bind(this))),l.appendChild(a)}handleSubmitNewConnection(e){e.preventDefault(),sessionStorage.clear();let t=!0;const n=e.target,o=new FormData(n),i={};for(const[e,n]of o.entries()){const o=n.toString();i[e]=o,"existingConnectionAlias"!==e&&0===o.length&&(t=!1)}const l=this.el.querySelector("#selectConnection"),s=this.connectionsTemplates[l.value].driver;i.driver=s,t?this.sendFormData(i):this.showErrorMessage("Error: Please fill in all fields.")}sendFormData(e){const t={method:"submit_new_connection",data:e};this.send(t)}handleMessage(e){if(["connection_error","connection_name_exists_error"].includes(e.method)&&this.showErrorMessage(e.message),"update_connections"===e.method&&(this.connections=JSON.parse(e.message),this.drawConnectionsList(this.connections)),"connected"===e.method){const t=e.message;this.activeConnection=t,this.markConnectedButton(t)}if("check_config_file"===e.method){const t=e.message,n=this.el.querySelector(".connections-guidelines .no-config-file");t?(n.style.display="none",this.el.querySelector(".connections-guidelines .no-config-file").style.display=0===this.connections.length?"block":"none"):n.style.display="block"}}markConnectedButton(e){this.el.querySelectorAll(".connection-button-actions .connectionStatusButton").forEach((e=>{const t=e;t.innerHTML="Connect",t.classList.remove("primary"),t.classList.add("secondary")}));const t=this.el.querySelector(`#connBtn_${e.replace(/ /g,"_")}`);t.innerText="Connected",t.classList.add("primary")}showErrorMessage(e){const t=this.el.querySelector(".user-error-message");t.querySelector("pre").innerHTML=`${e}`,t.style.display="block"}}const ie={...o,...i,...l},le=[C,d,U,{id:"jupysql-plugin:plugin",requires:[W.IJupyterWidgetRegistry],activate:function(e,t){t.registerWidget({name:J,version:z,exports:ie})},autoStart:!0},R]},9889:(e,t,n)=>{"use strict";n.d(t,{Z:()=>b});var o=n(3645),i=n.n(o),l=n(1667),s=n.n(l),a=n(9941),r=n.n(a),c=n(7152),d=n.n(c),u=n(3162),m=n.n(u),p=i()((function(e){return e[1]})),h=s()(r()),v=s()(d()),g=s()(m());p.push([e.id,":root {\n    --danger: #f53649;\n    --white: #ffffff;\n    --margin: 10px;\n    --primary: #206eef;\n}\n\n.connector-widget .connection-button-container .connection-button-actions {\n    display: inline-flex;\n    width: 100%;\n}\n\n.connector-widget #connectionsButtonsContainer {\n    display: grid;\n}\n\n.connector-widget .connection-button-container .delete-connection-button {\n    margin-left: 10px;\n    background-repeat: no-repeat;\n    background-size: 24px;\n    background-position: center;\n    background-image: url("+h+");\n    background-color: transparent;\n    border: none;\n    width: 24px;\n}\n\n.connector-widget .connection-button-container .edit-connection-button {\n    margin-left: 10px;\n    background-repeat: no-repeat;\n    background-size: 24px;\n    background-position: center;\n    background-image: url("+v+");\n    background-color: transparent;\n    border: none;\n    width: 26px;\n}\n\n.create-new-connection {\n    display: inline-flex;\n    color: var(--primary)\n}\n\n.create-new-connection:hover {\n    cursor: pointer;\n}\n\n.create-new-connection .icon {\n    background-image: url("+g+");\n    min-width: 30px;\n    height: 30px;\n    background-repeat: no-repeat;\n    background-size: 15px;\n    background-position: center;\n    background-color: transparent;\n    margin: 0;\n}\n\n.create-new-connection div {\n    margin: auto var(--margin);\n    margin-top: 2px;\n}\n\n.create-new-connection div:nth-child(2) {\n    margin-left: 2px;\n}\n\n.connector-widget .connection-button-container {\n    margin: var(--margin) 0;\n}\n\n.connector-widget hr.divider {\n    margin: 0;\n    margin-top: 20px;\n}\n\n.connector-widget button {\n    width: fit-content;\n    border: none;\n    padding: 5px 10px;\n    border: 1px solid transparent;\n    border-radius: 5px;\n}\n\n.connector-widget button.secondary {\n    background-color: transparent;\n    border: 1px solid var(--primary);\n    color: var(--primary);\n}\n\n.connector-widget button.primary {\n    background-color: var(--primary);\n    color: #fff;\n    border: 1px solid var(--primary);\n}\n\n.connector-widget .connection-button-actions .connection-name {\n    margin: auto 30px;\n    margin-left: 0;\n    width: 100%;\n    font-weight: 500;\n}\n\nbutton.danger {\n    background-color: var(--danger);\n    color: var(--white);\n    margin-left: var(--margin);\n}\n\nform#connectionForm .field-container {\n    display: inline-flex;\n    width: 100%;\n    margin: var(--margin) 0;\n}\n\nform#connectionForm label {\n    width: 50%;\n    margin: auto 0;\n}\n\nform#connectionForm .field {\n    width: -webkit-fill-available;\n    margin-left: var(--margin);\n    padding: 5px 10px;\n}\n\nform#connectionForm input:not(input[type='submit']) {\n    /* margin: 10px;\n    padding: 5px 10px; */\n}\n\n#selectConnection {\n    width: 100%;\n    padding: 6px 10px;\n    margin-bottom: var(--margin);\n}\n\n.warning-message {\n    margin-bottom: var(--margin);\n}\n\n.block {\n    margin: 30px 0px;\n    /* border: 1px solid #000; */\n    width: 600px;\n}\n\nform#connectionForm .buttons-container {\n    text-align: right;\n    margin: var(--margin) 0;\n}\n\nform#connectionForm .buttons-container button:first-child {\n    margin-right: var(--margin);\n}",""]);const b=p},7517:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var o=n(3645),i=n.n(o)()((function(e){return e[1]}));i.push([e.id,".custom-widget {\n    background-color: lightseagreen;\n    padding: 0px 2px;\n}",""]);const l=i},3162:e=>{e.exports="data:image/svg+xml,%3Csvg width='14' height='14' viewBox='0 0 14 14' fill='none' xmlns='http://www.w3.org/2000/svg'%3E %3Cpath d='M14 8H8V14H6V8H0V6H6V0H8V6H14V8Z' fill='%23206EEF'/%3E %3C/svg%3E"},9941:e=>{e.exports="data:image/svg+xml,%3Csvg height='427pt' viewBox='-40 0 427 427.00131' width='427pt' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='m232.398438 154.703125c-5.523438 0-10 4.476563-10 10v189c0 5.519531 4.476562 10 10 10 5.523437 0 10-4.480469 10-10v-189c0-5.523437-4.476563-10-10-10zm0 0'/%3E%3Cpath d='m114.398438 154.703125c-5.523438 0-10 4.476563-10 10v189c0 5.519531 4.476562 10 10 10 5.523437 0 10-4.480469 10-10v-189c0-5.523437-4.476563-10-10-10zm0 0'/%3E%3Cpath d='m28.398438 127.121094v246.378906c0 14.5625 5.339843 28.238281 14.667968 38.050781 9.285156 9.839844 22.207032 15.425781 35.730469 15.449219h189.203125c13.527344-.023438 26.449219-5.609375 35.730469-15.449219 9.328125-9.8125 14.667969-23.488281 14.667969-38.050781v-246.378906c18.542968-4.921875 30.558593-22.835938 28.078124-41.863282-2.484374-19.023437-18.691406-33.253906-37.878906-33.257812h-51.199218v-12.5c.058593-10.511719-4.097657-20.605469-11.539063-28.03125-7.441406-7.421875-17.550781-11.5546875-28.0625-11.46875h-88.796875c-10.511719-.0859375-20.621094 4.046875-28.0625 11.46875-7.441406 7.425781-11.597656 17.519531-11.539062 28.03125v12.5h-51.199219c-19.1875.003906-35.394531 14.234375-37.878907 33.257812-2.480468 19.027344 9.535157 36.941407 28.078126 41.863282zm239.601562 279.878906h-189.203125c-17.097656 0-30.398437-14.6875-30.398437-33.5v-245.5h250v245.5c0 18.8125-13.300782 33.5-30.398438 33.5zm-158.601562-367.5c-.066407-5.207031 1.980468-10.21875 5.675781-13.894531 3.691406-3.675781 8.714843-5.695313 13.925781-5.605469h88.796875c5.210937-.089844 10.234375 1.929688 13.925781 5.605469 3.695313 3.671875 5.742188 8.6875 5.675782 13.894531v12.5h-128zm-71.199219 32.5h270.398437c9.941406 0 18 8.058594 18 18s-8.058594 18-18 18h-270.398437c-9.941407 0-18-8.058594-18-18s8.058593-18 18-18zm0 0'/%3E%3Cpath d='m173.398438 154.703125c-5.523438 0-10 4.476563-10 10v189c0 5.519531 4.476562 10 10 10 5.523437 0 10-4.480469 10-10v-189c0-5.523437-4.476563-10-10-10zm0 0'/%3E%3C/svg%3E"},7152:e=>{e.exports="data:image/svg+xml,%3Csvg height='401pt' viewBox='0 -1 401.52289 401' width='401pt' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='m370.589844 250.972656c-5.523438 0-10 4.476563-10 10v88.789063c-.019532 16.5625-13.4375 29.984375-30 30h-280.589844c-16.5625-.015625-29.980469-13.4375-30-30v-260.589844c.019531-16.558594 13.4375-29.980469 30-30h88.789062c5.523438 0 10-4.476563 10-10 0-5.519531-4.476562-10-10-10h-88.789062c-27.601562.03125-49.96875 22.398437-50 50v260.59375c.03125 27.601563 22.398438 49.96875 50 50h280.589844c27.601562-.03125 49.96875-22.398437 50-50v-88.792969c0-5.523437-4.476563-10-10-10zm0 0'/%3E%3Cpath d='m376.628906 13.441406c-17.574218-17.574218-46.066406-17.574218-63.640625 0l-178.40625 178.40625c-1.222656 1.222656-2.105469 2.738282-2.566406 4.402344l-23.460937 84.699219c-.964844 3.472656.015624 7.191406 2.5625 9.742187 2.550781 2.546875 6.269531 3.527344 9.742187 2.566406l84.699219-23.464843c1.664062-.460938 3.179687-1.34375 4.402344-2.566407l178.402343-178.410156c17.546875-17.585937 17.546875-46.054687 0-63.640625zm-220.257812 184.90625 146.011718-146.015625 47.089844 47.089844-146.015625 146.015625zm-9.40625 18.875 37.621094 37.625-52.039063 14.417969zm227.257812-142.546875-10.605468 10.605469-47.09375-47.09375 10.609374-10.605469c9.761719-9.761719 25.589844-9.761719 35.351563 0l11.738281 11.734375c9.746094 9.773438 9.746094 25.589844 0 35.359375zm0 0'/%3E%3C/svg%3E"},4147:e=>{"use strict";e.exports=JSON.parse('{"name":"jupysql-plugin","version":"0.3.1","description":"Jupyterlab extension for JupySQL","private":true,"keywords":["jupyter","jupyterlab","jupyterlab-extension"],"homepage":"https://github.com/ploomber/jupysql-plugin.git","bugs":{"url":"https://github.com/ploomber/jupysql-plugin.git/issues"},"license":"BSD-3-Clause","author":{"name":"Ploomber","email":"contact@ploomber.io"},"files":["lib/**/*.{d.ts,eot,gif,html,jpg,js,js.map,json,png,svg,woff2,ttf}","style/**/*.{css,js,eot,gif,html,jpg,json,png,svg,woff2,ttf}","settings-schema/**/*.json"],"main":"lib/index.js","types":"lib/index.d.ts","style":"style/index.css","repository":{"type":"git","url":"https://github.com/ploomber/jupysql-plugin.git.git"},"workspaces":{"packages":["jupysql_plugin","ui-tests"]},"scripts":{"build":"jlpm build:lib && jlpm build:labextension:dev","build:prod":"jlpm clean && jlpm build:lib:prod && jlpm build:labextension","build:labextension":"jupyter labextension build .","build:labextension:dev":"jupyter labextension build --development True .","build:lib":"tsc --sourceMap","build:lib:prod":"tsc","clean":"jlpm clean:lib","clean:lib":"rimraf lib tsconfig.tsbuildinfo","clean:lintcache":"rimraf .eslintcache .stylelintcache","clean:labextension":"rimraf jupysql_plugin/labextension jupysql_plugin/_version.py","clean:all":"jlpm clean:lib && jlpm clean:labextension && jlpm clean:lintcache","eslint":"jlpm eslint:check --fix","eslint:check":"eslint src/ --cache --ext .ts,.tsx","install:extension":"jlpm build","lint":"jlpm stylelint && jlpm prettier && jlpm eslint","lint:check":"jlpm stylelint:check && jlpm prettier:check && jlpm eslint:check","prettier":"jlpm prettier:base --write --list-different","prettier:base":"prettier \\"**/*{.ts,.tsx,.js,.jsx,.css,.json,.md}\\"","prettier:check":"jlpm prettier:base --check","stylelint":"jlpm stylelint:check --fix","stylelint:check":"stylelint --cache \\"style/**/*.css\\"","test":"jest --coverage","watch":"run-p watch:src watch:labextension","watch:src":"tsc -w","watch:labextension":"jupyter labextension watch ."},"@comment":{"dependencies":{"@lumino/widgets":"An official library to implement the frontend of the widgets: https://github.com/jupyterlab/lumino"}},"dependencies":{"@emotion/react":"^11.11.0","@emotion/styled":"^11.11.0","@jupyter-widgets/base":"^6.0.4","@jupyterlab/application":"^3.6.2","@jupyterlab/codeeditor":"^3.6.2","@jupyterlab/codemirror":"^3.6.3","@jupyterlab/completer":"^3.6.2","@jupyterlab/notebook":"^3.6.2","@jupyterlab/settingregistry":"^3.6.5","@jupyterlab/statedb":"^3.6.2","@lumino/widgets":"<2.0.0","@mui/icons-material":"^5.11.16","@mui/material":"^5.13.4","@types/codemirror":"^5.60.7","@types/underscore":"^1.11.4","bootstrap":"^5.2.3","clean":"^4.0.2","react":"^17.0.2","sql-formatter":"^12.2.0","underscore":"^1.13.6"},"devDependencies":{"@babel/core":"^7.0.0","@babel/preset-env":"^7.0.0","@jupyterlab/builder":"^3.1.0","@jupyterlab/testutils":"^3.0.0","@testing-library/jest-dom":"^5.16.5","@testing-library/react":"^12.1.2","@types/bootstrap":"^5.2.6","@types/jest":"^26.0.0","@types/jest-when":"^3.5.2","@typescript-eslint/eslint-plugin":"^4.8.1","@typescript-eslint/parser":"^4.8.1","eslint":"^7.14.0","eslint-config-prettier":"^6.15.0","eslint-plugin-prettier":"^3.1.4","jest":"^26.0.0","jest-when":"^3.5.2","npm-run-all":"^4.1.5","prettier":"^2.1.1","react-dom":"^17.0.2","rimraf":"^3.0.2","stylelint":"^14.3.0","stylelint-config-prettier":"^9.0.4","stylelint-config-recommended":"^6.0.0","stylelint-config-standard":"~24.0.0","stylelint-prettier":"^2.0.0","ts-jest":"^26.0.0","typescript":"^4.1.3"},"sideEffects":["style/*.css","style/index.js"],"styleModule":"style/index.js","publishConfig":{"access":"public"},"jupyterlab":{"extension":true,"schemaDir":"settings-schema","outputDir":"jupysql_plugin/labextension","sharedPackages":{}}}')}}]);