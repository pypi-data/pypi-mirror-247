"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[90],{74521:function(e,t,n){var i=n(82394),r=n(92083),o=n.n(r),l=n(15338),u=n(97618),a=n(55485),d=n(65956),s=n(38276),c=n(71417),p=n(75499),v=n(30160),f=n(35686),m=n(3917),h=n(70515),g=n(8970),_=n(88422),j=n(10332),b=n(86735),x=n(70320),y=n(28598),E=n(82684);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.Z=function(e){var t=e.disableJobExpansion,n=e.disableStageExpansion,i=e.jobs,r=e.stagesMapping,O=(0,x.qB)();return(0,y.jsx)(p.Z,{apiForFetchingAfterAction:t?null:f.ZP.spark_jobs.detail,buildApiOptionsFromObject:t?null:function(e){var t,n,i,r;return[null===e||void 0===e?void 0:e.job_id,{application_id:null!==e&&void 0!==e&&null!==(t=e.application)&&void 0!==t&&t.calculated_id?encodeURIComponent(null===e||void 0===e||null===(n=e.application)||void 0===n?void 0:n.calculated_id):"",application_spark_ui_url:null!==e&&void 0!==e&&null!==(i=e.application)&&void 0!==i&&i.spark_ui_url?encodeURIComponent(null===e||void 0===e||null===(r=e.application)||void 0===r?void 0:r.spark_ui_url):""}]},columnFlex:[null,null,null,null,null,null],columns:[{uuid:"ID"},{uuid:"Name"},{uuid:"Submitted"},{uuid:"Status"},{center:!0,uuid:"Stages"},{center:!0,uuid:"Tasks"}],getObjectAtRowIndex:function(e){return null===i||void 0===i?void 0:i[e]},renderExpandedRowWithObject:t?null:function(e,t){var i=null===t||void 0===t?void 0:t.spark_job;if(i){var o=i.num_active_stages,p=i.num_active_tasks,f=i.num_completed_stages,m=i.num_completed_tasks,g=i.num_failed_stages,_=i.num_failed_tasks,x=i.num_killed_tasks,E=i.num_skipped_stages,O=i.num_skipped_tasks,P=i.num_tasks,Z=i.stage_ids,k=(0,b.YC)(Z,(function(e){return e}),{ascending:!1}).reduce((function(e,t){var n,o,l=null===r||void 0===r||null===(n=r[null===i||void 0===i||null===(o=i.application)||void 0===o?void 0:o.calculated_id])||void 0===n?void 0:n[t];return l?e.concat(l):l}),[]);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(s.Z,{p:h.cd,children:(0,y.jsxs)(a.ZP,{children:[(0,y.jsx)(u.Z,{flex:1,alignItems:"stretch",children:(0,y.jsxs)(d.Z,{noPadding:!0,children:[(0,y.jsx)(s.Z,{px:h.cd,py:h.cd,children:(0,y.jsx)(v.ZP,{bold:!0,large:!0,children:"Stage summary"})}),(0,y.jsx)(l.Z,{light:!0,short:!0}),(0,j.s)([["IDs",null===Z||void 0===Z?void 0:Z.join(", ")],["Completed",f],["Active",o],["Skipped",E],["Failed",g]])]})}),(0,y.jsx)(s.Z,{mr:h.cd}),(0,y.jsx)(u.Z,{flex:1,alignItems:"stretch",children:(0,y.jsxs)(d.Z,{noPadding:!0,children:[(0,y.jsx)(s.Z,{px:h.cd,py:h.cd,children:(0,y.jsx)(v.ZP,{bold:!0,large:!0,children:"Task summary"})}),(0,y.jsx)(l.Z,{light:!0,short:!0}),(0,j.s)([["Total",P],["Completed",m],["Active",p],["Skipped",O],["Failed",_],["Killed",x]])]})})]})}),(0,y.jsx)(l.Z,{light:!0}),(0,y.jsx)(s.Z,{p:h.cd,children:(0,y.jsxs)(d.Z,{noPadding:!0,children:[(0,y.jsx)(s.Z,{p:h.cd,children:(0,y.jsxs)(v.ZP,{bold:!0,large:!0,children:["Stages\xa0\xa0\xa0",(0,y.jsx)(v.ZP,{default:!0,inline:!0,large:!0,monospace:!0,children:null===k||void 0===k?void 0:k.length})]})}),(0,y.jsx)(l.Z,{light:!0}),(0,y.jsx)(c.Z,{disableStageExpansion:n,stages:k}),(0,y.jsx)(s.Z,{p:h.cd})]})})]})}return(0,y.jsx)(s.Z,{p:h.cd})},rows:null===i||void 0===i?void 0:i.map((function(e){var t=e.job_id,n=e.name,i=e.num_tasks,r=e.stage_ids,l=e.status,u=e.submission_time,a=(null===n||void 0===n?void 0:n.length)>=100?"".concat(null===n||void 0===n?void 0:n.slice(0,97),"..."):n;return[(0,E.createElement)(v.ZP,P(P({},g.eB),{},{key:"id"}),t),(0,E.createElement)(v.ZP,P(P({},g.eB),{},{key:"name",preWrap:!0,title:n}),a),(0,E.createElement)(v.ZP,P(P({},g.eB),{},{key:"submittedAt"}),u?(0,m.XG)(o()(u,m.kE).format(m.BL),O):"-"),(0,E.createElement)(v.ZP,P(P({},g.eB),{},{danger:_.CN.FAILED===l,key:"status",success:_.CN.SUCCEEDED===l}),l),(0,E.createElement)(v.ZP,P(P({},g.eB),{},{center:!0,key:"stageIds"}),(null===r||void 0===r?void 0:r.length)||"-"),(0,E.createElement)(v.ZP,P(P({},g.eB),{},{center:!0,key:"tasks"}),i)]})),uuid:"jobs"})}},72748:function(e,t,n){n.d(t,{Z:function(){return A}});var i=n(21831),r=n(82394),o=n(38626),l=n(82684),u=n(75499),a=n(30160),d=n(44897),s=n(42631),c=n(31608),p=n(70515),v=c.DI,f=2*p.iI,m=5*p.iI+2*f,h=o.default.div.withConfig({displayName:"indexstyle__NodeStyle",componentId:"sc-9bk2jw-0"})(["border-radius:","px;"," ",""],s.n_,(function(e){return"\n    background-color: ".concat((e.theme||d.Z).background.dashboard,";\n    border: 1px solid ").concat((e.theme||d.Z).borders.light,";\n  ")}),(function(e){return e.height&&"\n    height: ".concat(e.height,"px;\n  ")})),g=o.default.div.withConfig({displayName:"indexstyle__NodeHeaderStyle",componentId:"sc-9bk2jw-1"})(["padding-left:","px;padding-right:","px;padding-top:","px;padding-bottom:","px;",""],v,v,f,f,(function(e){return"\n    border-bottom: 1px solid ".concat((e.theme||d.Z).borders.light,";\n  ")})),_=n(8970),j=n(28598);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(e){var t=e.height,n=e.node,i=(0,l.useMemo)((function(){return(null===n||void 0===n?void 0:n.metrics)||[]}),n),r=(0,l.useMemo)((function(){return(0,j.jsx)(u.Z,{columnFlex:[null,null],columns:[{uuid:"Metric"},{rightAligned:!0,uuid:"Value"}],rows:null===i||void 0===i?void 0:i.map((function(e){var t=e.name,n=e.value;return[(0,l.createElement)(a.ZP,x(x({},_.eB),{},{key:"name"}),t),(0,l.createElement)(a.ZP,x(x({},_.eB),{},{key:"value",rightAligned:!0}),n)]}))})}),[i]);return(0,j.jsxs)(h,{height:t,children:[(0,j.jsx)(g,{children:(0,j.jsx)(a.ZP,{monospace:!0,children:null===n||void 0===n?void 0:n.node_name})}),(null===i||void 0===i?void 0:i.length)>=1&&r]})},E=n(35686),O=n(24138),P=n(21978),Z=n(55187),k=n(99543);function S(e){var t=(null===e||void 0===e?void 0:e.metrics)||[],n=m,i=new RegExp("\n","g"),r=0;null===t||void 0===t||t.forEach((function(e){var t=e.name,n=e.value;r+=1;var o=[];[t,n].forEach((function(e){var t=e.matchAll(i);if(t){for(var n=0;"undefined"!==typeof t.next().value;)n+=1;o.push(n)}})),r+=Math.max.apply(Math,o)}));var o=(null===t||void 0===t?void 0:t.length)||0;return o>=1&&(n+=37,n+=18*(r||0),n+=17*(o||0)),n}function w(e){var t=(null===e||void 0===e?void 0:e.node_name)||"",n=(null===e||void 0===e?void 0:e.metrics)||[],r=Math.max.apply(Math,[(null===t||void 0===t?void 0:t.length)||0].concat((0,i.Z)(null===n||void 0===n?void 0:n.map((function(e){var t=e.name,n=e.value;return((null===t||void 0===t?void 0:t.length)||0)+((null===n||void 0===n?void 0:n.length)||0)}))))),o=2*v+r*(k.YE+.3);return null!==n&&void 0!==n&&n.length&&(o+=4*v),o}var R=n(86735);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A=function(e){var t,n,r,u,a=e.disableGraph,d=e.height,s=e.heightOffset,c=e.model,p=e.overrideScroll,v=e.treeRef,f=(0,l.useRef)(null),m=v||f,h=(0,l.useContext)(o.ThemeContext),g=E.ZP.spark_sqls.detail(null===c||void 0===c?void 0:c.id,{application_id:null!==c&&void 0!==c&&null!==(t=c.application)&&void 0!==t&&t.calculated_id?encodeURIComponent(null===c||void 0===c||null===(n=c.application)||void 0===n?void 0:n.calculated_id):"",application_spark_ui_url:null!==c&&void 0!==c&&null!==(r=c.application)&&void 0!==r&&r.spark_ui_url?encodeURIComponent(null===c||void 0===c||null===(u=c.application)||void 0===u?void 0:u.spark_ui_url):"",include_jobs_and_stages:1,_format:"with_jobs_and_stages"}).data,_=(0,l.useMemo)((function(){return null===g||void 0===g?void 0:g.spark_sql}),[g]),b=(0,l.useMemo)((function(){return(0,R.HK)((null===_||void 0===_?void 0:_.jobs)||[],(function(e){return e.job_id}))}),[_]),x=(0,l.useMemo)((function(){return(0,R.HK)((null===_||void 0===_?void 0:_.stages)||[],(function(e){return e.stage_id}))}),[_]),k=(0,l.useMemo)((function(){var e,t=[],n=[],r=(null===_||void 0===_?void 0:_.edges)||[],o=((0,R.vM)(r,(function(e){return e.from_id})),(0,R.vM)(r,(function(e){return e.to_id})),{});return null===r||void 0===r||r.forEach((function(e){var t=e.from_id,i=e.to_id;n.push({from:t,fromPort:"".concat(t,"-").concat(i,"-from"),id:"".concat(t,"-").concat(i),to:i,toPort:"".concat(t,"-").concat(i,"-to")}),t in o||(o[t]=[]),o[t].push(T(T({},P.bJ),{},{disabled:!0,id:"".concat(t,"-").concat(i,"-from"),side:P.rl.SOUTH})),i in o||(o[i]=[]),o[i].push(T(T({},P.bJ),{},{disabled:!0,id:"".concat(t,"-").concat(i,"-to"),side:P.rl.NORTH}))})),null===_||void 0===_||null===(e=_.nodes)||void 0===e||e.forEach((function(e){var n=null===e||void 0===e?void 0:e.node_id,r=(0,i.Z)((null===o||void 0===o?void 0:o[n])||[]);t.push({data:{sqlNode:e},height:S(e),id:n,ports:r,width:w(e)})})),{edges:n,nodes:t}}),[b,_,x]),C=k.edges,A=k.nodes;(0,l.useEffect)((function(){a||setTimeout((function(){var e,t,n,i,r;0===(null===m||void 0===m||null===(e=m.current)||void 0===e||null===(t=e.containerRef)||void 0===t||null===(n=t.current)||void 0===n?void 0:n.scrollTop)&&(null===m||void 0===m||null===(i=m.current)||void 0===i||null===(r=i.fitCanvas)||void 0===r||r.call(i))}),1e3)}),[m,a]);var I=(0,l.useMemo)((function(){var e=0;return d&&(e+=d),s&&(e-=s),Math.max(0,e)}),[d,s]),N=(0,l.useCallback)((function(e){e.preventDefault()}),[]);(0,l.useEffect)((function(){var e,t,n,i,r,o;a?null===m||void 0===m||null===(e=m.current)||void 0===e||null===(t=e.containerRef)||void 0===t||null===(n=t.current)||void 0===n||n.addEventListener("wheel",N):null===m||void 0===m||null===(i=m.current)||void 0===i||null===(r=i.containerRef)||void 0===r||null===(o=r.current)||void 0===o||o.removeEventListener("wheel",N)}),[a,N]);var M=(0,l.useCallback)((function(e){e.stopPropagation()}),[]);return(0,l.useEffect)((function(){var e,t,n,i,r,o;p?null===m||void 0===m||null===(e=m.current)||void 0===e||null===(t=e.containerRef)||void 0===t||null===(n=t.current)||void 0===n||n.addEventListener("wheel",M):null===m||void 0===m||null===(i=m.current)||void 0===i||null===(r=i.containerRef)||void 0===r||null===(o=r.current)||void 0===o||o.removeEventListener("wheel",M)}),[p,M]),(0,j.jsx)(Z.$4,{height:I,onDoubleClick:function(){var e,t;return null===m||void 0===m||null===(e=m.current)||void 0===e||null===(t=e.fitCanvas)||void 0===t?void 0:t.call(e)},children:(0,j.jsx)(O.Xz,{arrow:null,disabled:a,edge:function(e){var t;return(0,j.jsx)(O.kS,T(T({},e),{},{style:{stroke:null===h||void 0===h||null===(t=h.accent)||void 0===t?void 0:t.purple}}))},edges:C,fit:!0,forwardedRef:m,maxHeight:P.Jo,maxWidth:P.Jo,maxZoom:1,minZoom:-.7,node:function(e){var t,n;return(0,j.jsx)(O.NB,T(T({},e),{},{dragType:"port",linkable:!0,port:(0,j.jsx)(O.GR,{style:{fill:null===h||void 0===h||null===(t=h.borders)||void 0===t?void 0:t.light,stroke:null===h||void 0===h||null===(n=h.accent)||void 0===n?void 0:n.purple,strokeWidth:"1px"}}),style:{fill:"transparent",stroke:"transparent",strokeWidth:0},children:function(e){var t=e.height,n=e.node.data.sqlNode;return(0,j.jsx)("foreignObject",{height:t,width:e.width,x:0,y:0,children:(0,j.jsx)(y,{height:t,node:n})})}}))},nodes:A})})}},93004:function(e,t,n){var i=n(82394),r=n(92083),o=n.n(r),l=n(82684),u=n(32013),a=n(98777),d=n(15338),s=n(97618),c=n(55485),p=n(74521),v=n(85854),f=n(65956),m=n(38276),h=n(72748),g=n(75499),_=n(30160),j=n(35686),b=n(3917),x=n(70515),y=n(8970),E=n(88422),O=n(81728),P=n(70320),Z=n(28598);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.Z=function(e){var t=e.disableGraph,n=e.disableJobExpansion,i=e.overrideScrollForGraph,r=e.setSelectedSql,k=e.showSparkGraph,w=e.sqls,R=e.stagesMapping,C=(0,P.qB)(),T=j.ZP.spark_sqls.list({length:9999},{},{pauseFetch:"undefined"!==typeof w&&null!==w}).data,A=(0,l.useMemo)((function(){return w||((null===T||void 0===T?void 0:T.spark_sqls)||[])}),[T,w]),I=(0,l.useMemo)((function(){var e,P={};null===A||void 0===A||A.forEach((function(e){var t,n,i=null===e||void 0===e?void 0:e.application;(null===i||void 0===i?void 0:i.calculated_id)in P||(P[null===i||void 0===i?void 0:i.calculated_id]={application:i,sqls:[]}),null===(t=P[null===i||void 0===i?void 0:i.calculated_id])||void 0===t||null===(n=t.sqls)||void 0===n||n.push(e)}));var w=null===(e=Object.values(P))||void 0===e?void 0:e.length;return Object.values(P).map((function(e){var P=e.application,T=e.sqls;return(0,Z.jsxs)("div",{children:[w>=2&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(m.Z,{p:x.cd,children:(0,Z.jsxs)(_.ZP,{default:!0,bold:!0,children:["Application ",null===P||void 0===P?void 0:P.calculated_id]})}),(0,Z.jsx)(d.Z,{light:!0})]}),(0,Z.jsx)(g.Z,{apiForFetchingAfterAction:j.ZP.spark_sqls.detail,buildApiOptionsFromObject:function(e){var t,n,i,r;return[null===e||void 0===e?void 0:e.id,{application_id:null!==e&&void 0!==e&&null!==(t=e.application)&&void 0!==t&&t.calculated_id?encodeURIComponent(null===e||void 0===e||null===(n=e.application)||void 0===n?void 0:n.calculated_id):"",application_spark_ui_url:null!==e&&void 0!==e&&null!==(i=e.application)&&void 0!==i&&i.spark_ui_url?encodeURIComponent(null===e||void 0===e||null===(r=e.application)||void 0===r?void 0:r.spark_ui_url):"",include_jobs_and_stages:1,_format:"with_jobs_and_stages"}]},columnFlex:[null,null,null,null,null,null,null],columns:[{uuid:"ID"},{uuid:"Submitted"},{center:!0,uuid:"Duration"},{uuid:"Status"},{center:!0,uuid:"Successful jobs"},{center:!0,uuid:"Running jobs"},{center:!0,uuid:"Failed jobs"}],getObjectAtRowIndex:function(e){return null===T||void 0===T?void 0:T[e]},onClickRow:function(e){var t=null===T||void 0===T?void 0:T[e];null===r||void 0===r||r((function(e){return e&&(null===e||void 0===e?void 0:e.id)===(null===t||void 0===t?void 0:t.id)?null:t}))},renderExpandedRowWithObject:function(e,r){var o,l=null===r||void 0===r||null===(o=r.spark_sql)||void 0===o?void 0:o.jobs,d=null===T||void 0===T?void 0:T[e];return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(m.Z,{p:x.cd,children:(0,Z.jsxs)(f.Z,{noPadding:!0,children:[(0,Z.jsx)(m.Z,{p:x.cd,children:(0,Z.jsx)(c.ZP,{alignItems:"center",justifyContent:"space-between",children:(0,Z.jsxs)(s.Z,{flex:1,flexDirection:"column",children:[(0,Z.jsx)(v.Z,{level:5,children:"Description"}),(0,Z.jsx)(m.Z,{mt:1,children:(0,Z.jsx)(_.ZP,{default:!0,monospace:!0,children:null===d||void 0===d?void 0:d.description})})]})})}),(0,Z.jsx)(m.Z,{p:x.cd,children:(0,Z.jsxs)(u.Z,{noBoxShadow:!0,children:[(0,Z.jsx)(a.Z,{noPaddingContent:!0,title:"Plan",titleXPadding:x.cd*x.iI,titleYPadding:1.5*x.iI,children:(0,Z.jsx)(m.Z,{p:x.cd,children:(0,Z.jsx)(_.ZP,{default:!0,monospace:!0,preWrap:!0,small:!0,children:null===d||void 0===d?void 0:d.plan_description})})}),k&&(0,Z.jsx)(a.Z,{noPaddingContent:!0,title:"Graph",titleXPadding:x.cd*x.iI,titleYPadding:1.5*x.iI,children:(0,Z.jsx)(h.Z,{disableGraph:t,height:100*x.iI,model:d,overrideScroll:i})})]})})]})}),(0,Z.jsxs)(m.Z,{mb:x.cd,px:x.cd,children:[(0,Z.jsx)(m.Z,{mb:x.cd,children:(0,Z.jsx)(c.ZP,{alignItems:"center",justifyContent:"space-between",children:(0,Z.jsx)(s.Z,{flex:1,flexDirection:"column",children:(0,Z.jsx)(v.Z,{level:5,children:"Jobs"})})})}),(0,Z.jsxs)(f.Z,{overflowVisible:!0,noPadding:!0,children:[(0,Z.jsx)(p.Z,{disableJobExpansion:n,jobs:l,stagesMapping:R}),(0,Z.jsx)(m.Z,{pb:x.cd})]})]})]})},rows:null===T||void 0===T?void 0:T.map((function(e){var t=e.duration,n=e.failed_job_ids,i=e.id,r=e.running_job_ids,u=e.status,a=e.submission_time,d=e.success_job_ids;return[(0,l.createElement)(_.ZP,S(S({},y.eB),{},{key:"id"}),i),(0,l.createElement)(_.ZP,S(S({},y.eB),{},{key:"submissionTime"}),a?(0,b.XG)(o()(a,b.kE).format(b.OC),C):"-"),(0,l.createElement)(_.ZP,S(S({},y.eB),{},{center:!0,key:"duration"}),t?(0,O.NR)(t):0),(0,l.createElement)(_.ZP,S(S({},y.eB),{},{key:"status",success:E.oD.COMPLETED===u}),u),(0,l.createElement)(_.ZP,S(S({},y.eB),{},{center:!0,key:"successJobIds"}),null===d||void 0===d?void 0:d.length),(0,l.createElement)(_.ZP,S(S({},y.eB),{},{center:!0,key:"runningJobIds"}),null===r||void 0===r?void 0:r.length),(0,l.createElement)(_.ZP,S(S({},y.eB),{},{center:!0,key:"failedJobIds"}),null===n||void 0===n?void 0:n.length)]}))})]},null===P||void 0===P?void 0:P.calculated_id)}))}),[t,i,A,R]);return(0,Z.jsx)(Z.Fragment,{children:I})}},71417:function(e,t,n){n.d(t,{Z:function(){return D}});var i=n(82394),r=n(92083),o=n.n(r),l=n(15338),u=n(97618),a=n(55485),d=n(65956),s=n(38276),c=n(75499),p=n(38626),v=n(82684),f=n(39867),m=n(30160),h=n(12468),g=n(44897),_=n(70515),j=3*_.iI,b=p.default.div.withConfig({displayName:"indexstyle__BarsContainerStyle",componentId:"sc-15hlddf-0"})(["width:100%;"]),x=p.default.div.withConfig({displayName:"indexstyle__BarContainerStyle",componentId:"sc-15hlddf-1"})(["align-items:center;display:flex;height:","px;width:100%;"],j),y=p.default.div.withConfig({displayName:"indexstyle__BarStyle",componentId:"sc-15hlddf-2"})(["height:100%;"," "," "," "," "," "," "," "," ",""],(function(e){return e.widthPercentage&&"\n    width: ".concat(100*e.widthPercentage,"%;\n  ")}),(function(e){return e.blue&&"\n    background-color: ".concat((e.theme||g.Z).accent.blue,";\n  ")}),(function(e){return e.green&&"\n    background-color: ".concat((e.theme||g.Z).accent.positive,";\n  ")}),(function(e){return e.orange&&"\n    background-color: ".concat((e.theme||g.Z).accent.dbt,";\n  ")}),(function(e){return e.purple&&"\n    background-color: ".concat((e.theme||g.Z).accent.purple,";\n  ")}),(function(e){return e.red&&"\n    background-color: ".concat((e.theme||g.Z).accent.negative,";\n  ")}),(function(e){return e.teal&&"\n    background-color: ".concat((e.theme||g.Z).accent.teal,";\n  ")}),(function(e){return e.yellow&&"\n    background-color: ".concat((e.theme||g.Z).accent.yellow,";\n  ")}),(function(e){return e.empty&&"\n    background-color: ".concat((e.theme||g.Z).background.chartBlock,";\n  ")})),E=p.default.div.withConfig({displayName:"indexstyle__FillerStyle",componentId:"sc-15hlddf-3"})(["height:","px;width:100%;"],j),O=p.default.div.withConfig({displayName:"indexstyle__TextStyle",componentId:"sc-15hlddf-4"})(["align-items:center;display:flex;height:","px;justify-content:flex-end;"],j),P=n(3917),Z=n(70320),k=n(86735),S=n(28598);var w=function(e){var t,n=e.stageAttempt,i=(0,v.useContext)(p.ThemeContext),r=(0,Z.qB)(),l=(n.submission_time,(0,v.useMemo)((function(){return(0,k.YC)(Object.values((null===n||void 0===n?void 0:n.tasks)||{}),(function(e){return e.launch_time}),{ascending:!0})}),[n])),d=(0,v.useMemo)((function(){var e,t;return null===l||void 0===l||l.forEach((function(n){var i=n.duration,r=n.launch_time,l=o()(r,P.kE).valueOf();(!t||l<t)&&(t=l);var u=l+i;(!e||u>e)&&(e=u)})),{maxEndTimestamp:e,minLaunchTimestamp:t}}),[l]),c=d.maxEndTimestamp,g=d.minLaunchTimestamp,j=(0,v.useCallback)((function(e){return(0,S.jsx)(h.Z,{appearAbove:!0,block:!0,fullSize:!0,label:(0,S.jsx)(m.ZP,{leftAligned:!0,children:e}),lightBackground:!0,muted:!0,widthFitContent:!0,children:(0,S.jsx)(E,{})})}),[]),w=(0,v.useMemo)((function(){var e=c-g,t=[];return null===l||void 0===l||l.forEach((function(n,i){var r=n.duration,l=n.task_id,u=n.launch_time,a=n.scheduler_delay,d=n.task_metrics,p=d.executor_deserialize_time,v=d.shuffle_read_metrics.fetch_wait_time,f=d.executor_run_time,m=d.shuffle_write_metrics.write_time,h=d.result_serialization_time,_=n.getting_result_time,b=o()(u,P.kE).valueOf(),E=b+r,O=[(0,S.jsx)(y,{empty:!0,widthPercentage:(b-g)/e,children:j("Waiting to start")},"launchTimestamp"),(0,S.jsx)(y,{blue:!0,widthPercentage:a/e,children:j("Scheduler delay")},"schedulerDelay"),(0,S.jsx)(y,{red:!0,widthPercentage:p/e,children:j("Task deserialization time")},"executorDeserializeTime"),(0,S.jsx)(y,{orange:!0,widthPercentage:v/e,children:j("Shuffle read time")},"fetchWaitTime"),(0,S.jsx)(y,{green:!0,widthPercentage:f/e,children:j("Executor computing time")},"executorRunTime"),(0,S.jsx)(y,{widthPercentage:m/e,yellow:!0,children:j("Shuffle write time")},"writeTime"),(0,S.jsx)(y,{purple:!0,widthPercentage:h/e,children:j("Result serialization time")},"resultSerializationTime"),(0,S.jsx)(y,{teal:!0,widthPercentage:_/e,children:j("Getting result time")},"gettingResultTime"),(0,S.jsx)(y,{empty:!0,widthPercentage:(c-E)/e,children:j("Already finished")},"endTime")];t.push((0,S.jsx)(s.Z,{mt:1},"divider-".concat(l))),t.push((0,S.jsx)(x,{children:O},l))})),(0,S.jsxs)(b,{children:[(0,S.jsx)(x,{children:(0,S.jsxs)(a.ZP,{fullWidth:!0,justifyContent:"space-between",children:[(0,S.jsx)(u.Z,{flex:1,children:(0,S.jsx)(m.ZP,{monospace:!0,muted:!0,children:(0,P.XG)((0,P.Mg)(g,{withMilliseconds:!0}).format(P.OC),r)})}),(0,S.jsx)(u.Z,{flex:1,justifyContent:"flex-end",children:(0,S.jsx)(m.ZP,{monospace:!0,muted:!0,children:(0,P.XG)((0,P.Mg)(c,{withMilliseconds:!0}).format(P.OC),r)})})]})}),t]})}),[c,g,j,l]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(s.Z,{mb:_.cd,children:(0,S.jsx)(m.ZP,{bold:!0,large:!0,children:"Task timeline"})}),(0,S.jsx)(s.Z,{mb:_.cd,children:[{color:null===i||void 0===i||null===(t=i.accent)||void 0===t?void 0:t.blue,uuid:"Scheduler delay"},{color:null===i||void 0===i?void 0:i.accent.negative,uuid:"Task deserialization time"},{color:null===i||void 0===i?void 0:i.accent.dbt,uuid:"Shuffle read time"},{color:null===i||void 0===i?void 0:i.accent.positive,uuid:"Executor computing time"},{color:null===i||void 0===i?void 0:i.accent.yellow,uuid:"Shuffle write time"},{color:null===i||void 0===i?void 0:i.accent.purple,uuid:"Result serialization time"},{color:null===i||void 0===i?void 0:i.accent.teal,uuid:"Getting result time"}].map((function(e,t){var n=e.color,i=e.uuid;return(0,S.jsx)(s.Z,{mt:t>=1?1:0,children:(0,S.jsxs)(a.ZP,{alignItems:"center",children:[(0,S.jsx)(f.Z,{color:n,size:1*_.iI}),(0,S.jsx)(s.Z,{mr:1}),(0,S.jsx)(m.ZP,{default:!0,children:i})]})},i)}))}),(0,S.jsxs)(a.ZP,{children:[(0,S.jsxs)("div",{children:[(0,S.jsx)(O,{children:(0,S.jsx)(m.ZP,{bold:!0,monospace:!0,muted:!0,noWrapping:!0,children:"ID"})}),null===l||void 0===l?void 0:l.map((function(e,t){var n=e.task_id;return(0,S.jsx)(s.Z,{mt:1,children:(0,S.jsx)(O,{children:(0,S.jsx)(m.ZP,{default:!0,monospace:!0,noWrapping:!0,children:n})})},n)}))]}),(0,S.jsx)(s.Z,{mr:2}),w]})]})},R=n(35686),C=n(88422),T=n(8970),A=n(10332),I=n(81728);function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var D=function(e){var t=e.disableStageExpansion,n=e.stages,i=e.tasksContained,r=(0,Z.qB)();return(0,S.jsx)(c.Z,{columnFlex:[null,null,null,null,null,null,null,null,null,null,null,null,null],columns:[{uuid:"ID"},{center:!0,uuid:"Attempt"},{uuid:"Name"},{uuid:"Submitted"},{center:!0,uuid:"Duration"},{uuid:"Status"},{center:!0,uuid:"Tasks"},{center:!0,tooltipMessage:"Bytes read from storage in this stage",uuid:"In"},{center:!0,uuid:"In recs"},{center:!0,tooltipMessage:"Bytes written in storage in this stage",uuid:"Out"},{center:!0,uuid:"Out recs"},{center:!0,tooltipMessage:"Total shuffle bytes and records read, includes both data read locally and data read from remote executors.",uuid:"Sh read"},{rightAligned:!0,tooltipMessage:"Bytes and records written to disk in order to be read by a shuffle in a future stage.",uuid:"Sh write"}],getObjectAtRowIndex:function(e){return null===n||void 0===n?void 0:n[e]},buildApiOptionsFromObject:t?null:function(e){var t,n,i,r;return[null===e||void 0===e?void 0:e.stage_id,{application_id:null!==e&&void 0!==e&&null!==(t=e.application)&&void 0!==t&&t.calculated_id?encodeURIComponent(null===e||void 0===e||null===(n=e.application)||void 0===n?void 0:n.calculated_id):"",application_spark_ui_url:null!==e&&void 0!==e&&null!==(i=e.application)&&void 0!==i&&i.spark_ui_url?encodeURIComponent(null===e||void 0===e||null===(r=e.application)||void 0===r?void 0:r.spark_ui_url):"",quantiles:C.k$.map((function(e){return e})).join(","),withSummaries:!0}]},apiForFetchingAfterAction:t?null:R.ZP.spark_stages.detail,renderExpandedRowWithObject:t?null:function(e,t){var p,f,g=null===n||void 0===n?void 0:n[e];if(!g)return(0,S.jsx)("div",{});var j=g.details,b=g.num_active_tasks,x=g.num_complete_tasks,y=g.num_failed_tasks,E=g.num_killed_tasks,O=g.num_tasks,Z=null===t||void 0===t||null===(p=t.spark_stage)||void 0===p?void 0:p.stage_attempts;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(s.Z,{p:_.cd,children:(0,S.jsxs)(a.ZP,{children:[(0,S.jsx)(u.Z,{flex:1,alignItems:"stretch",children:(0,S.jsxs)(d.Z,{noPadding:!0,children:[(0,S.jsx)(s.Z,{px:_.cd,py:_.cd,children:(0,S.jsx)(m.ZP,{bold:!0,large:!0,children:"Task summary"})}),(0,S.jsx)(l.Z,{light:!0,short:!0}),(0,A.s)([["Total",O],["Completed",x],["Active",b],["Failed",y],["Killed",E]])]})}),(0,S.jsx)(s.Z,{mr:_.cd}),(0,S.jsx)(u.Z,{flex:2,alignItems:"stretch",children:(0,S.jsxs)(d.Z,{noPadding:!0,children:[(0,S.jsx)(s.Z,{px:_.cd,py:_.cd,children:(0,S.jsx)(m.ZP,{bold:!0,large:!0,children:"Details"})}),(0,S.jsx)(l.Z,{light:!0,short:!0}),(0,S.jsx)(s.Z,{p:_.cd,children:null===j||void 0===j||null===(f=j.split("\n"))||void 0===f?void 0:f.map((function(e){return(0,S.jsx)(m.ZP,{muted:!0,monospace:!0,small:!0,children:e},e)}))})]})})]})}),null===Z||void 0===Z?void 0:Z.map((function(e){e.attempt_id;var t,n=e.task_metrics_distributions,p=e.tasks,f=n||{},g=f.input_metrics,j=f.output_metrics,b=f.quantiles,x=void 0===b?C.k$:b,y=f.shuffle_read_metrics,E=f.shuffle_write_metrics,O=(0,S.jsx)(c.Z,{columnFlex:[null,null,null,null,null,null,null,null,null],columns:[{uuid:"ID"},{center:!0,uuid:"Attempt"},{uuid:"Status"},{uuid:"Locality"},{uuid:"Launch"},{center:!0,uuid:"Duration"},{center:!0,tooltipMessage:"GC time is the total JVM garbage collection time.",uuid:"GC time"},{center:!0,tooltipMessage:"Scheduler delay is the time the task waits to be scheduled for execution.",uuid:"Delayed"},{center:!0,tooltipMessage:"Result serialization time is the time spent serializing the task result on an executor before sending it back to the driver.",uuid:"Result time"}],rows:(0,k.YC)(Object.values(p||{}),(function(e){return e.task_id}),{ascending:!1}).map((function(e){var t=e.attempt,n=e.duration,i=e.launch_time,l=e.scheduler_delay,u=e.status,a=e.task_id,d=e.task_locality,s=e.task_metrics;return[(0,v.createElement)(m.ZP,M(M({},T.eB),{},{key:"taskId"}),a),(0,v.createElement)(m.ZP,M(M({},T.eB),{},{center:!0,key:"attempt"}),t),(0,v.createElement)(m.ZP,M(M({},T.eB),{},{key:"status",success:C.q.SUCCESS===u}),u),(0,v.createElement)(m.ZP,M(M({},T.eB),{},{key:"taskLocality"}),d),(0,v.createElement)(m.ZP,M(M({},T.eB),{},{key:"launchTime"}),i?(0,P.XG)(o()(i,P.kE).format(P.BL),r):"-"),(0,v.createElement)(m.ZP,M(M({},T.eB),{},{center:!0,key:"duration"}),n?(0,I.NR)(n):0),(0,v.createElement)(m.ZP,M(M({},T.eB),{},{center:!0,key:"jvmGcTime"}),null!==s&&void 0!==s&&s.jvm_gc_time?(0,I.NR)(null===s||void 0===s?void 0:s.jvm_gc_time):0),(0,v.createElement)(m.ZP,M(M({},T.eB),{},{center:!0,key:"schedulerDelay"}),l?(0,I.NR)(l):0),(0,v.createElement)(m.ZP,M(M({},T.eB),{},{center:!0,key:"resultSerializationTime"}),null!==s&&void 0!==s&&s.result_serialization_time?(0,I.NR)(null===s||void 0===s?void 0:s.result_serialization_time):0)]}))});return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(l.Z,{light:!0}),(0,S.jsx)(s.Z,{p:_.cd,children:(0,S.jsx)(w,{stageAttempt:e})}),(0,S.jsx)(l.Z,{light:!0}),(0,S.jsx)(s.Z,{px:_.cd,mt:_.cd,children:(0,S.jsx)(a.ZP,{children:(0,S.jsx)(u.Z,{flex:1,alignItems:"stretch",children:(0,S.jsxs)(d.Z,{noPadding:!0,children:[(0,S.jsx)(s.Z,{px:_.cd,py:_.cd,children:(0,S.jsxs)(m.ZP,{bold:!0,large:!0,children:["Summary metrics for ",(0,I._6)("completed task",null===e||void 0===e?void 0:e.num_complete_tasks)]})}),(0,S.jsx)(l.Z,{light:!0,short:!0}),(0,S.jsx)(c.Z,{columnFlex:[null].concat(null===x||void 0===x?void 0:x.map((function(){return null}))),columns:[{uuid:"Metric"}].concat((null===x||void 0===x?void 0:x.map((function(e,t){return{center:!0,label:function(){return 0===t?"Min":t===(null===x||void 0===x?void 0:x.length)-1?"Max":t===Math.floor((null===x||void 0===x?void 0:x.length)/2)?"Median":"".concat(Number(100*e),"th")},uuid:e}})))||[]),rows:[{uuid:"Duration",values:((null===n||void 0===n?void 0:n.duration)||[]).map((function(e){return(0,I.NR)(e)}))},{tooltipMessage:"GC time is the total JVM garbage collection time.",uuid:"GC time",values:((null===n||void 0===n?void 0:n.jvm_gc_time)||[]).map((function(e){return(0,I.NR)(e)}))},{tooltipMessage:"Bytes read from storage in this stage.",uuid:"Input read (bytes)",values:(null===g||void 0===g?void 0:g.bytes_read)||[]},{tooltipMessage:"Records read from storage in this stage.",uuid:"Input records read",values:(null===g||void 0===g?void 0:g.records_read)||[]},{tooltipMessage:"Total shuffle bytes read, includes both data read locally and data read from remote executors.",uuid:"Shuffle read (bytes)",values:(null===y||void 0===y?void 0:y.read_bytes)||[]},{tooltipMessage:"Total shuffle records read, includes both data read locally and data read from remote executors.",uuid:"Shuffle read records",values:(null===y||void 0===y?void 0:y.read_records)||[]},{uuid:"Shuffle read fetch time",values:((null===y||void 0===y?void 0:y.fetch_wait_time)||[]).map((function(e){return(0,I.NR)(e)}))},{tooltipMessage:"Bytes written to storage in this stage.",uuid:"Input write (bytes)",values:(null===j||void 0===j?void 0:j.bytes_written)||[]},{tooltipMessage:"Records written to storage in this stage.",uuid:"Input records write",values:(null===j||void 0===j?void 0:j.records_written)||[]},{tooltipMessage:"Bytes written to disk in order to be read by a shuffle in a future stage.",uuid:"Shuffle write (bytes)",values:(null===E||void 0===E?void 0:E.write_bytes)||[]},{tooltipMessage:"Records written to disk in order to be read by a shuffle in a future stage.",uuid:"Shuffle write records",values:(null===E||void 0===E?void 0:E.write_records)||[]},{uuid:"Shuffle write time",values:((null===E||void 0===E?void 0:E.write_time)||[]).map((function(e){return(0,I.NR)(e)}))},{tooltipMessage:"Scheduler delay is the time the task waits to be scheduled for execution.",uuid:"Scheduler delay",values:(null===n||void 0===n?void 0:n.scheduler_delay)||[]},{uuid:"Task deserialization time",values:((null===n||void 0===n?void 0:n.executor_deserialize_time)||[]).map((function(e){return(0,I.NR)(e)}))},{uuid:"Task deserialization CPU time",values:((null===n||void 0===n?void 0:n.executor_deserialize_cpu_time)||[]).map((function(e){return(0,I.NR)(e)}))},{uuid:"Result size",values:(null===n||void 0===n?void 0:n.result_size)||[]},{tooltipMessage:"Result serialization time is the time spent serializing the task result on an executor before sending it back to the driver.",uuid:"Result serialization time",values:((null===n||void 0===n?void 0:n.result_serialization_time)||[]).map((function(e){return(0,I.NR)(e)}))},{tooltipMessage:"Getting result time is the time that the driver spends fetching task results from workers.",uuid:"Getting result time",values:((null===n||void 0===n?void 0:n.getting_result_time)||[]).map((function(e){return(0,I.NR)(e)}))},{tooltipMessage:"Scheduler delay is the time the task waits to be scheduled for execution.",uuid:"Scheduler delay",values:((null===n||void 0===n?void 0:n.scheduler_delay)||[]).map((function(e){return(0,I.NR)(e)}))},{tooltipMessage:"Peak execution memory is the maximum memory used by the internal data structures created during shuffles, aggregations and joins.",uuid:"Peak execution memory",values:(null===n||void 0===n?void 0:n.peak_execution_memory)||[]},{tooltipMessage:"Shuffle spill (memory) is the size of the deserialized form of the shuffled data in memory.",uuid:"Memory spilled (bytes)",values:(null===n||void 0===n?void 0:n.memory_bytes_spilled)||[]},{tooltipMessage:"Shuffle spill (disk) is the size of the serialized form of the data on disk.",uuid:"Disk spilled (bytes)",values:(null===n||void 0===n?void 0:n.disk_bytes_spilled)||[]}].map((function(e){var t=e.tooltipMessage,n=e.uuid,i=e.values;return[(0,S.jsxs)(a.ZP,{alignItems:"center",children:[(0,S.jsx)(m.ZP,M(M({},T.eB),{},{children:n})),t&&(0,S.jsx)("div",{style:{marginLeft:4},children:(0,S.jsx)(h.Z,{appearAbove:!0,label:(0,S.jsx)(m.ZP,{leftAligned:!0,children:t}),lightBackground:!0,maxWidth:200,muted:!0})})]},n)].concat(null===i||void 0===i?void 0:i.map((function(e,t){return(0,v.createElement)(m.ZP,M(M({},T.eB),{},{center:!0,key:"quantile-".concat(x[t],"-").concat(n)}),e)})))}))}),(0,S.jsx)(s.Z,{p:1})]})})})}),(0,S.jsx)(s.Z,{p:_.cd,children:(0,S.jsxs)(m.ZP,{bold:!0,large:!0,children:["Tasks\xa0\xa0\xa0",(0,S.jsx)(m.ZP,{default:!0,inline:!0,large:!0,monospace:!0,children:p?null===(t=Object.keys(p||{}))||void 0===t?void 0:t.length:""})]})}),!i&&O,i&&(0,S.jsx)(s.Z,{px:_.cd,children:(0,S.jsxs)(d.Z,{noPadding:!0,children:[O,(0,S.jsx)(s.Z,{pb:_.cd})]})}),(0,S.jsx)(s.Z,{p:1})]})}))]})},rows:null===n||void 0===n?void 0:n.map((function(e){var t=e.attempt_id,n=e.completion_time,i=e.first_task_launched_time,l=e.input_bytes,u=e.input_records,a=e.name,d=e.output_bytes,s=e.output_records,c=e.shuffle_read_bytes,p=e.shuffle_write_bytes,f=e.stage_id,h=e.status,g=e.submission_time,_=e.tasks,j=i&&o()(i,P.kE),b=n&&o()(n,P.kE),x=b&&b.diff(j),y=(null===a||void 0===a?void 0:a.length)>=12?"".concat(null===a||void 0===a?void 0:a.slice(0,9),"..."):a;return[(0,v.createElement)(m.ZP,M(M({},T.eB),{},{key:"stageID"}),f),(0,v.createElement)(m.ZP,M(M({},T.eB),{},{center:!0,key:"attemptID"}),t),(0,v.createElement)(m.ZP,M(M({},T.eB),{},{key:"displayName",title:a}),y),(0,v.createElement)(m.ZP,M(M({},T.eB),{},{key:"submissionTime"}),g?(0,P.XG)(o()(g,P.kE).format(P.BL),r):"-"),(0,v.createElement)(m.ZP,M(M({},T.eB),{},{key:"diffDisplayText",center:!0}),x?(0,I.NR)(x):0),(0,v.createElement)(m.ZP,M(M({},T.eB),{},{key:"status",success:C.Dd.COMPLETE===h}),h),(0,v.createElement)(m.ZP,M(M({},T.eB),{},{key:"tasks",center:!0}),Object.keys(_||{}).length||0),(0,v.createElement)(m.ZP,M(M({},T.eB),{},{center:!0,key:"inputBytes"}),l),(0,v.createElement)(m.ZP,M(M({},T.eB),{},{center:!0,key:"inputRecords"}),u),(0,v.createElement)(m.ZP,M(M({},T.eB),{},{center:!0,key:"outputBytes"}),d),(0,v.createElement)(m.ZP,M(M({},T.eB),{},{center:!0,key:"outputRecords"}),s),(0,v.createElement)(m.ZP,M(M({},T.eB),{},{center:!0,key:"shuffleReadBytes"}),c),(0,v.createElement)(m.ZP,M(M({},T.eB),{},{key:"shuffleWriteBytes",rightAligned:!0}),p)]}))})}},8970:function(e,t,n){n.d(t,{sY:function(){return k},l:function(){return O},Eb:function(){return P},LF:function(){return Z},B2:function(){return y},TD:function(){return E},uK:function(){return b},eB:function(){return S},kI:function(){return w}});var i=n(82394),r=n(28598),o=69.063,l=o/85;var u,a,d,s,c=function(e){var t,n,i=e.height,u=e.size,a=e.width;return u?(t=u/l,n=u):i?(t=i,n=i*l):a&&(t=a/l,n=a),(0,r.jsxs)("svg",{fill:"#fff",fillRule:"evenodd",height:t,stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 ".concat(o," ").concat(85),width:n,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[(0,r.jsx)("use",{xlinkHref:"#A",x:"2.031",y:"2.5"}),(0,r.jsx)("symbol",{id:"A",overflow:"visible",children:(0,r.jsxs)("g",{stroke:"none",children:[(0,r.jsx)("path",{d:"M16.829 39.981L13.086 62.83l-9.812 2.283-3.255-1.659V39.981h16.81z",fill:"#9d5025"}),(0,r.jsx)("path",{d:"M65 31.932l-32.5 2.351L0 31.932 32.5 0 65 31.932z",fill:"#6b3b19"}),(0,r.jsx)("path",{d:"M38.971 39.981H3.274v25.132l35.697-8.322v-16.81z",fill:"#f58534"}),(0,r.jsx)("path",{d:"M21.127 39.981l1.168 25.698-11.43 3.298-3.992-2.029V39.981h14.254z",fill:"#9d5025"}),(0,r.jsx)("path",{d:"M49.664 39.981H10.865v28.995l38.799-11.22V39.981z",fill:"#f58534"}),(0,r.jsx)("path",{d:"M29.255 39.981v30.507l-8.912 3.317-5.016-2.556V39.981h13.929z",fill:"#9d5025"}),(0,r.jsx)("path",{d:"M58.117 39.981H20.342v33.824l37.775-14.078V39.981z",fill:"#f58534"}),(0,r.jsx)("path",{d:"M26.019 76.703V39.981h24.602l11.803 24.771L32.49 80.001l-6.471-3.297z",fill:"#9d5025"}),(0,r.jsx)("path",{d:"M32.49 80.001v-40.02h32.5v23.464l-32.5 16.556zM65 31.932l-32.5-5.697V0L65 16.556v15.376z",fill:"#f58534"}),(0,r.jsx)("path",{d:"M0 31.932l32.5-5.697V0L0 16.556v15.376z",fill:"#9d5025"})]})})]})},p=n(55485),v=n(30160),f=n(72473),m=n(74260),h=n(70515),g=n(81728);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b,x=8*h.iI,y=j({},m.GO);!function(e){e.CLUSTERS="clusters",e.MONITORING="monitoring",e.RESOURCES="resources",e.SETUP="setup",e.SYSTEM="system"}(b||(b={}));var E=(u={},(0,i.Z)(u,b.CLUSTERS,"Clusters"),(0,i.Z)(u,b.RESOURCES,"Resources"),(0,i.Z)(u,b.MONITORING,"Monitoring"),(0,i.Z)(u,b.SETUP,"Setup"),(0,i.Z)(u,b.SYSTEM,"System"),u),O=(a={},(0,i.Z)(a,y.AWS_EMR,"AWS EMR"),(0,i.Z)(a,y.STANDALONE_CLUSTER,"Standalone cluster"),a),P=(d={},(0,i.Z)(d,y.AWS_EMR,"Spark"),(0,i.Z)(d,y.STANDALONE_CLUSTER,"Spark"),d),Z=(s={},(0,i.Z)(s,y.AWS_EMR,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x;return(0,r.jsx)(c,{height:e})})),(0,i.Z)(s,y.STANDALONE_CLUSTER,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x;return(0,r.jsx)(f.Hm,{size:e,warning:!0})})),s),k=[{buildPayload:function(e){return{emr_config:null,spark_config:j({app_name:"",spark_master:"local"},null===e||void 0===e?void 0:e.spark_config)}},displayName:O[y.STANDALONE_CLUSTER],documentationHref:"https://docs.mage.ai/integrations/spark-pyspark#standalone-spark-cluster",kicker:P[y.STANDALONE_CLUSTER],renderIcon:Z[y.STANDALONE_CLUSTER],uuid:y.STANDALONE_CLUSTER},{buildPayload:function(e){return{emr_config:j({master_instance_type:""},null===e||void 0===e?void 0:e.emr_config),spark_config:j({app_name:""},null===e||void 0===e?void 0:e.spark_config)}},displayName:O[y.AWS_EMR],documentationHref:"https://docs.mage.ai/integrations/spark-pyspark#aws",kicker:P[y.AWS_EMR],renderIcon:Z[y.AWS_EMR],uuid:y.AWS_EMR}],S={default:!0,monospace:!0,preWrap:!0,small:!0};function w(e){var t=[{Icon:f.Zr,uuid:b.SETUP},{Icon:f.hd,uuid:b.RESOURCES}];return m.GO.AWS_EMR===(null===e||void 0===e?void 0:e.uuid)&&t.push.apply(t,[{Icon:f.su,renderStatus:function(e){var t=e.clusters;return e.clustersLoading?null:(0,r.jsx)(v.ZP,{default:!0,large:!0,monospace:!0,children:null===t||void 0===t?void 0:t.length})},uuid:b.CLUSTERS}]),[m.GO.AWS_EMR,m.GO.STANDALONE_CLUSTER].includes(null===e||void 0===e?void 0:e.uuid)&&t.push.apply(t,[{Icon:f.ug,renderStatus:function(e){var t=e.applications,n=e.applicationsLoading,i=e.jobs;e.jobsLoading;return n?null:(0,r.jsxs)(p.ZP,{flexDirection:"column",justifyContent:"flex-end",children:[(0,r.jsx)(v.ZP,{default:!0,monospace:!0,rightAligned:!0,xsmall:!0,children:(0,g._6)("application",(null===t||void 0===t?void 0:t.length)||0)}),(0,r.jsx)("div",{style:{marginBottom:h.iI/2}}),(0,r.jsx)(v.ZP,{default:!0,monospace:!0,rightAligned:!0,xsmall:!0,children:(0,g._6)("job",(null===i||void 0===i?void 0:i.length)||0)})]})},uuid:b.MONITORING},{Icon:f.m1,uuid:b.SYSTEM}]),t}},10332:function(e,t,n){n.d(t,{d:function(){return a},s:function(){return d}});var i=n(75499),r=n(30160),o=n(74260),l=n(42122),u=n(28598);function a(e){if(!(0,l.Qr)((null===e||void 0===e?void 0:e.spark_config)||{}))return(0,l.Qr)((null===e||void 0===e?void 0:e.emr_config)||{})?o.GO.STANDALONE_CLUSTER:o.GO.AWS_EMR}function d(e){return(0,u.jsx)(i.Z,{columnFlex:[null,1],columns:[{uuid:"Attribute"},{uuid:"Value"}],rows:e.map((function(e){return[(0,u.jsx)(r.ZP,{monospace:!0,muted:!0,small:!0,children:e[0]},"attribute"),(0,u.jsx)(r.ZP,{monospace:!0,muted:!0,small:!0,children:e[1]},"value")]}))})}},74260:function(e,t,n){var i,r,o;n.d(t,{GO:function(){return i},IK:function(){return o},br:function(){return r}}),function(e){e.AWS_EMR="AWS_EMR",e.STANDALONE_CLUSTER="STANDALONE_CLUSTER"}(i||(i={})),function(e){e.COMPLETED="completed",e.ERROR="error",e.INCOMPLETE="incomplete"}(r||(r={})),function(e){e.ACTIVATE_CLUSTER="activate_cluster",e.AWS_ACCESS_KEY_ID="AWS_ACCESS_KEY_ID",e.AWS_SECRET_ACCESS_KEY="AWS_SECRET_ACCESS_KEY",e.CLUSTER_CONNECTION="cluster_connection",e.CONFIGURE="configure",e.CREDENTIALS="credentials",e.EC2_KEY_NAME="ec2_key_name",e.EC2_KEY_PAIR="ec2_key_pair",e.EC2_KEY_PATH="ec2_key_path",e.IAM_PROFILE="iam_instance_profile",e.LAUNCH_CLUSTER="launch_cluster",e.OBSERVABILITY="observability",e.PERMISSIONS="permissions",e.PERMISSIONS_SSH="permissions_ssh",e.REMOTE_VARIABLES_DIR="remote_variables_dir",e.SETUP="setup"}(o||(o={}))},72098:function(e,t,n){var i;n.d(t,{U:function(){return i}}),function(e){e.PYSPARK="pysparkkernel",e.PYTHON3="python3"}(i||(i={}))},57653:function(e,t,n){n.d(t,{$1:function(){return m},G7:function(){return _},LM:function(){return j},Mj:function(){return b},QK:function(){return f},RH:function(){return g},a_:function(){return y},fj:function(){return E},kA:function(){return x},qL:function(){return u},r0:function(){return h}});var i,r,o,l,u,a=n(75582),d=n(82394),s=n(72473),c=n(72098);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,d.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.INTEGRATION="integration",e.PYTHON="python",e.PYSPARK="pyspark",e.STREAMING="streaming"}(u||(u={}));var f,m,h,g=(i={},(0,d.Z)(i,u.INTEGRATION,"Integration"),(0,d.Z)(i,u.PYTHON,"Python"),(0,d.Z)(i,u.PYSPARK,"PySpark"),(0,d.Z)(i,u.STREAMING,"Streaming"),i),_=(r={},(0,d.Z)(r,u.INTEGRATION,"Integration"),(0,d.Z)(r,u.PYTHON,"Standard"),(0,d.Z)(r,u.PYSPARK,"PySpark"),(0,d.Z)(r,u.STREAMING,"Streaming"),r),j="all",b=(u.PYTHON,u.INTEGRATION,u.STREAMING,o={},(0,d.Z)(o,j,s.ie),(0,d.Z)(o,u.INTEGRATION,s.YC),(0,d.Z)(o,u.PYTHON,s.El),(0,d.Z)(o,u.STREAMING,s.dB),o);!function(e){e.ACTIVE="active",e.INACTIVE="inactive",e.NO_SCHEDULES="no_schedules",e.RETRY="retry",e.RETRY_INCOMPLETE_BLOCK_RUNS="retry_incomplete_block_runs"}(f||(f={})),function(e){e.GROUP="group_by",e.HISTORY_DAYS="from_history_days",e.NO_TAGS="no_tags",e.SEARCH="search",e.STATUS="status[]",e.TAG="tag[]",e.TYPE="type[]"}(m||(m={})),function(e){e.STATUS="status",e.TAG="tag",e.TYPE="type"}(h||(h={}));var x=[f.ACTIVE,f.INACTIVE,f.NO_SCHEDULES],y=(l={},(0,d.Z)(l,u.PYTHON,c.U.PYTHON3),(0,d.Z)(l,u.PYSPARK,c.U.PYSPARK),l),E=Object.entries(y).reduce((function(e,t){var n=(0,a.Z)(t,2),i=n[0],r=n[1];return v(v({},e),{},(0,d.Z)({},r,i))}),{})},88422:function(e,t,n){var i,r,o,l,u;n.d(t,{CN:function(){return i},Dd:function(){return r},k$:function(){return a},oD:function(){return u},q:function(){return l}}),function(e){e.FAILED="FAILED",e.RUNNING="RUNNING",e.SUCCEEDED="SUCCEEDED"}(i||(i={})),function(e){e.COMPLETE="COMPLETE",e.PENDING="PENDING",e.SKIPPED="SKIPPED"}(r||(r={})),function(e){e.NODE_LOCAL="NODE_LOCAL",e.PROCESS_LOCAL="PROCESS_LOCAL",e.RACK_LOCAL="RACK_LOCAL"}(o||(o={})),function(e){e.SUCCESS="SUCCESS"}(l||(l={})),function(e){e.COMPLETED="COMPLETED"}(u||(u={}));var a=[.01,.25,.5,.75,.99]},35185:function(e,t,n){var i=n(82394),r=n(91835),o=(n(82684),n(38626)),l=n(44897),u=n(42631),a=n(70515),d=n(28598);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=o.default.div.withConfig({displayName:"ProgressBar__ProgressBarContainerStyle",componentId:"sc-10x9ojc-0"})(["border-radius:","px;height:","px;overflow:hidden;position:relative;width:100%;",""],u.BG,.75*a.iI,(function(e){return"\n    background-color: ".concat((e.theme.monotone||l.Z.monotone).grey200,";\n  ")})),v=o.default.div.withConfig({displayName:"ProgressBar__ProgressBarStyle",componentId:"sc-10x9ojc-1"})(["height:inherit;position:absolute;"," "," "," ",""],(function(e){return!e.danger&&"\n    background-color: ".concat((e.theme.progress||l.Z.progress).positive,";\n  ")}),(function(e){return e.progress&&"\n    width: ".concat(e.progress,"%;\n  ")}),(function(e){return e.danger&&"\n    background-color: ".concat((e.theme.progress||l.Z.progress).negative,";\n  ")}),(function(e){return e.animateProgress&&"\n    animation: animate-progress ".concat(e.animateProgress.duration,"ms linear forwards;\n\n    @keyframes animate-progress {\n      0% {\n        width: ").concat(e.animateProgress.start,"%;\n      }\n\n      100% {\n        width: ").concat(e.animateProgress.end,"%;\n      }\n    }\n  ")}));t.Z=function(e){var t=(0,r.Z)({},e);return(0,d.jsx)(p,c(c({},t),{},{children:(0,d.jsx)(v,c({},t))}))}}}]);