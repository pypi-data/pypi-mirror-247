"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5332],{46978:function(e,n,t){t.d(n,{Cl:function(){return u},Nk:function(){return c},ZG:function(){return l}});var o=t(38626),r=t(44897),i=t(70515),l=1.5*i.iI,u=1*l+i.iI/2,c=o.default.div.withConfig({displayName:"indexstyle__ContainerStyle",componentId:"sc-uvd91-0"})([".row:hover{","}"],(function(e){return"\n      background-color: ".concat((e.theme.interactive||r.Z.interactive).hoverBackground,";\n    ")}))},85332:function(e,n,t){t.d(n,{Z:function(){return ge}});var o=t(82394),r=t(75582),i=t(26304),l=t(82684),u=t(38626),c=t(69864),a=t(44425),d=t(70374),s=t(39867),f=t(89706),v=t(97618),p=t(30160),h=t(32929),m=t(72473),b="CUSTOM_EVENT_NAME_FOLDER_EXPAND",g=t(46978),j=t(70515),y=t(85385),C=t(53808),w=t(55283),k=t(53005),x=t(86735),O=t(81728),D=t(28598);function E(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function Z(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?E(Object(t),!0).forEach((function(n){(0,o.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):E(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var P="default_repo";var F=function e(n){var t,r=n.allowEmptyFolders,i=n.allowSelectingFolders,u=n.containerRef,c=n.disableContextMenu,d=n.file,E=n.isFileDisabled,F=n.level,_=n.onClickFile,I=n.onClickFolder,S=n.onSelectBlockFile,R=n.onlyShowChildren,L=n.openFile,T=n.openPipeline,N=n.openSidekickView,M=n.pipelineBlockUuids,A=n.renderAfterContent,U=n.selectFile,B=n.setContextItem,Q=n.setCoordinates,z=n.setDraggingFile,G=n.setSelectedFile,Y=n.theme,$=n.timeout,q=n.uncollapsed,W=n.useRootFolder,H=n.uuidCombined,X=(0,C.U2)(C.lQ,{}),K=d.children,J=d.disabled,V=d.name,ee=d.parent,ne=[].concat(H||[]).concat(V||P),te=null===ne||void 0===ne?void 0:ne.join("/");V||r||(d.name=P);var oe=W?(0,k.a9)(d):(0,k.jN)(d),re=(null===ee||void 0===ee?void 0:ee.name)===f.oy,ie=(0,l.useMemo)((function(){return K?(0,x.YC)(K,(function(e){return e.children?0:1})):K}),[K]),le=E?E(oe,ie):J,ue=E?E(oe,ie):J,ce=Array.isArray(ie)&&(null===ie||void 0===ie?void 0:ie.length)>0&&te in X?null===X||void 0===X?void 0:X[te]:F>=1,ae=(0,l.useState)("undefined"===typeof q?ce:!q),de=ae[0],se=ae[1];(0,l.useEffect)((function(){var e=function(e){var n=e.detail,t=n.collapsed,r=(n.file,n.folder);r&&null!==te&&void 0!==te&&te.startsWith(null===r||void 0===r?void 0:r.uuid)&&((0,C.rQ)(C.lQ,(0,o.Z)({},te,t)),se(t))};return window.addEventListener(b,e),function(){window.removeEventListener(b,e)}}),[se,te]);var fe=null===ne||void 0===ne||null===(t=ne.find)||void 0===t?void 0:t.call(ne,(function(e){return(0,O.C5)(e)in a.GJ})),ve=fe?(0,O.C5)(fe):null,pe=!!ie,he=pe&&fe&&fe===V,me=fe&&!pe&&(0,k.y)(V)&&(0,k.o$)(V,ve),be=fe?(0,w.qn)(ve,{theme:Y}).accent:null,ge=m.iU;1===F&&V===f.oy?ge=m.B_:V===f.PF?ge=m.GQ:pe?ge=he&&(null===h.iK||void 0===h.iK?void 0:h.iK[ve])||m.Bu:!V&&r&&(ge=m.mH);var je=s.Z;a.tf.CHART===ve&&(je=m.GQ);var ye=(0,l.useMemo)((function(){return null===ie||void 0===ie?void 0:ie.map((function(n){return(0,D.jsx)(e,{allowEmptyFolders:r,allowSelectingFolders:i,containerRef:u,disableContextMenu:c,file:Z(Z({},n),{},{parent:d}),isFileDisabled:E,level:R?F:F+1,onClickFile:_,onClickFolder:I,onSelectBlockFile:S,openFile:L,openPipeline:T,openSidekickView:N,pipelineBlockUuids:M,renderAfterContent:A,selectFile:U,setContextItem:B,setCoordinates:Q,setDraggingFile:z,setSelectedFile:G,theme:Y,timeout:$,uncollapsed:q,useRootFolder:W,uuidCombined:ne},"".concat(te,"/").concat((null===n||void 0===n?void 0:n.name)||P))}))}),[r,i,ie,u,c,d,E,F,_,I,S,R,L,T,N,M,A,U,B,Q,z,G,Y,$,q,W,te,ne]),Ce=(0,l.useMemo)((function(){var e=[];return(0,x.w6)(F).forEach((function(n,t){var o,r=g.Cl-1;e.push((0,D.jsx)("div",{style:{borderLeft:"1px solid ".concat(null===Y||void 0===Y||null===(o=Y.content)||void 0===o?void 0:o.disabled),height:22,marginLeft:r/2-2,paddingLeft:r/2+2}},"line-".concat(te,"-").concat(t)))})),e}),[F,Y,te]);return(0,D.jsxs)(D.Fragment,{children:[!R&&(0,D.jsxs)("div",{className:"row",onClick:function(e){if(e.preventDefault(),!ue){if((null===ee||void 0===ee?void 0:ee.name)===f.PF){null===N||void 0===N||N(y.cH.CHARTS);var n=(0,k.lr)(d);n&&(null===S||void 0===S||S(n.uuid,n.type,(0,k.jN)(d)))}var t=(0,k.V3)(d);if(ie)i?U(oe):se((function(e){var n=!e;return(0,C.rQ)(C.lQ,(0,o.Z)({},te,n)),n})),null===I||void 0===I||I(oe);else if(_)_(oe);else if(t)null===S||void 0===S||S(t.uuid,t.type,(0,k.jN)(d),{file:d,path:oe});else if(V.match(f.xF))null===L||void 0===L||L(oe);else{var r=(0,k.lr)(d);r&&(null===S||void 0===S||S(r.uuid,r.type,(0,k.jN)(d)))}}},onContextMenu:function(e){var n;clearTimeout($.current),null!==u&&void 0!==u&&null!==(n=u.current)&&void 0!==n&&n.contains(e.target)&&!c&&(e.preventDefault(),Q({x:e.pageX,y:e.pageY}),z(null),G(Z(Z({},d),{},{uuid:te})))},onMouseDown:function(e){var n,t=d?(0,k.lr)(d,null,!0):null;null===u||void 0===u||null===(n=u.current)||void 0===n||!n.contains(e.target)||!t||(null===ie||void 0===ie?void 0:ie.length)>=1||c||ue||re||(e.preventDefault(),clearTimeout($.current),$.current=setTimeout((function(){Q({x:e.pageX,y:e.pageY}),z(d),G(null)}),300))},style:{alignItems:"center",cursor:"default",display:"flex",minWidth:F*g.Cl+d.name.length*j.Fo+2*j.iI,paddingRight:j.iI/4},children:[(0,D.jsxs)(v.Z,{alignItems:"center",flex:1,children:[Ce,ie&&!de&&(0,D.jsx)(m._M,{muted:!0,size:g.ZG}),ie&&de&&(0,D.jsx)(m._Q,{muted:!0,size:g.ZG}),!ie&&(0,D.jsx)("div",{style:{width:g.ZG}}),(0,D.jsx)("div",{style:{marginLeft:j.iI/2,marginRight:j.iI/2},children:fe&&!pe&&me?(0,D.jsx)(je,{color:be,size:fe&&!pe?.7*g.ZG:g.ZG,square:!0}):(0,D.jsx)(ge,{fill:he?be:null,disabled:le,size:g.ZG})}),(0,D.jsx)(p.ZP,{default:!ue,disabled:ue,monospace:!0,small:!0,children:V})]}),A&&A(d)]}),(0,D.jsx)("div",{style:{display:de?"none":"block"},children:ye})]})},_=t(71180),I=t(55485),S=t(93369),R=t(65956),L=t(38276),T=t(17488),N=t(35686),M=t(42122),A=t(72619);var U=function(e){var n=e.fetchFileTree,t=e.file,o=e.moveFile,i=e.onCancel,u=e.onCreateFile,a=e.selectedFolder,d=e.setErrors,s=(0,l.useRef)(null),f=(0,M.Qr)(t)?null:t,v=(0,l.useState)(f?(0,k.jN)(f,null,!0):""),p=v[0],h=v[1],m=(0,l.useState)(f?null===f||void 0===f?void 0:f.name:""),b=m[0],g=m[1];(0,l.useEffect)((function(){var e;null===s||void 0===s||null===(e=s.current)||void 0===e||e.focus()}),[]),(0,l.useEffect)((function(){a&&h((0,k.jN)(a))}),[a]);var j=(0,c.Db)(N.ZP.files.useCreate(),{onSuccess:function(e){return(0,A.wD)(e,{callback:function(e){var t=e.file;null===n||void 0===n||n(),i(),null===u||void 0===u||u(t)},onErrorCallback:function(e,n){return d({errors:n,response:e})}})}}),y=(0,r.Z)(j,1)[0],C=(0,c.Db)(N.ZP.files.useUpdate(f&&encodeURIComponent((0,k.jN)(f))),{onSuccess:function(e){return(0,A.wD)(e,{callback:function(){null===n||void 0===n||n(),i()},onErrorCallback:function(e,n){return d({errors:n,response:e})}})}}),w=(0,r.Z)(C,1)[0];return(0,D.jsxs)(R.Z,{footer:(0,D.jsxs)(I.ZP,{children:[(0,D.jsxs)(S.ZP,{bold:!0,disabled:!b,inline:!0,onClick:function(){return f?w({file:{dir_path:p,name:b},file_json_only:!0}):y({file:{dir_path:p,name:b,overwrite:!1},file_json_only:!0})},primary:!0,tabIndex:0,uuid:"NewFile/create_file",children:[f?o?"Move":"Rename":"Create"," file"]}),(0,D.jsx)(L.Z,{ml:1,children:(0,D.jsx)(_.ZP,{onClick:function(){return i()},tabIndex:0,children:"Cancel"})})]}),headerTitle:f?o?"Move file":"Rename file":"New file",children:[(0,D.jsx)(T.Z,{disabled:!!f&&!o,label:"Directory",monospace:!0,onChange:function(e){return h(e.target.value)},setContentOnMount:!0,value:p}),(0,D.jsx)(L.Z,{mt:2,children:(0,D.jsx)(T.Z,{disabled:!!o,label:"Filename",monospace:!0,onChange:function(e){return g(e.target.value)},ref:s,required:!0,value:b})})]})};var B=function(e){var n=e.fetchFileTree,t=e.file,o=e.moveFile,i=e.onCancel,u=e.onCreateFile,a=e.selectedFolder,d=e.setErrors,s=(0,l.useRef)(null),f=(0,M.Qr)(t)?null:t,v=(0,l.useState)(f?(0,k.jN)(f,null,!0):""),p=v[0],h=v[1],m=(0,l.useState)(f?null===f||void 0===f?void 0:f.name:""),b=m[0],g=m[1];(0,l.useEffect)((function(){var e;null===s||void 0===s||null===(e=s.current)||void 0===e||e.focus()}),[]),(0,l.useEffect)((function(){a&&h((0,k.jN)(a,null,!0))}),[a]);var j=(0,c.Db)(N.ZP.folders.useCreate(),{onSuccess:function(e){return(0,A.wD)(e,{callback:function(e){var t=e.file;null===n||void 0===n||n(),i(),null===u||void 0===u||u(t)},onErrorCallback:function(e,n){return d({errors:n,response:e})}})}}),y=(0,r.Z)(j,1)[0],C=(0,c.Db)(N.ZP.folders.useUpdate(f&&encodeURIComponent((0,k.jN)(f))),{onSuccess:function(e){return(0,A.wD)(e,{callback:function(){null===n||void 0===n||n(),i()},onErrorCallback:function(e,n){return d({errors:n,response:e})}})}}),w=(0,r.Z)(C,1)[0];return(0,D.jsxs)(R.Z,{footer:(0,D.jsxs)(I.ZP,{children:[(0,D.jsxs)(S.ZP,{bold:!0,disabled:!b,inline:!0,onClick:function(){return f?w({folder:{name:b,path:p}}):y({folder:{name:b,overwrite:!1,path:p}})},primary:!0,tabIndex:0,uuid:"NewFolder/create_folder",children:[f?o?"Move":"Rename":"Create"," folder"]}),(0,D.jsx)(L.Z,{ml:1,children:(0,D.jsx)(_.ZP,{onClick:function(){return i()},tabIndex:0,children:"Cancel"})})]}),headerTitle:f?o?"Move folder":"Rename folder":"New folder",children:[(0,D.jsx)(T.Z,{disabled:!!f&&!o,label:"Directory",monospace:!0,onChange:function(e){return h(e.target.value)},setContentOnMount:!0,value:p}),(0,D.jsx)(L.Z,{mt:2,children:(0,D.jsx)(T.Z,{disabled:!!o,label:"Folder name",monospace:!0,onChange:function(e){return g(e.target.value)},ref:s,required:!0,value:b})})]})},Q=t(57653),z=t(89515),G=t(17717),Y=t(77011);function $(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function q(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?$(Object(t),!0).forEach((function(n){(0,o.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):$(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var W=u.default.div.withConfig({displayName:"MultiFileInput__DropzoneStyle",componentId:"sc-1l6yd2y-0"})(["&:hover{cursor:pointer;}"]);var H=function(e){var n=e.children,t=e.inputOnChange,o=e.inputProps,r=e.onDragActiveChange,i=e.setFiles,u=(0,l.useCallback)((function(e){i(e)}),[i]),c=(0,Y.uI)({onDrop:u}),a=c.getInputProps,d=c.getRootProps,s=c.isDragActive,f=a(),v=f.accept,p=f.autoComplete,h=f.multiple,m=f.onChange,b=f.onClick,g=f.ref,j=f.style,y=f.tabIndex,C=f.type,w=q(q({},o),{},{accept:v,autoComplete:p,multiple:h,onChange:function(e){null===t||void 0===t||t(e),null===o||void 0===o||o.onChange(e),m(e)},onClick:b,ref:g,style:j,tabIndex:y,type:C});return(0,l.useEffect)((function(){null===r||void 0===r||r(s)}),[s,r]),(0,D.jsxs)(W,q(q({},d()),{},{children:[(0,D.jsx)("input",q(q({},w),{},{directory:"",webkitdirectory:""})),n]}))};function X(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function K(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?X(Object(t),!0).forEach((function(n){(0,o.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):X(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var J=function(e){var n=e.children,t=e.directoryPath,i=e.onDragActiveChange,u=e.setFileUploadProgress,a=e.setUploadedFiles,d=(0,c.Db)(N.ZP.files.useCreate({onUploadProgress:function(e,n){var t,r=n.body,i=[null===r||void 0===r?void 0:r.dir_path,null===r||void 0===r||null===(t=r.file)||void 0===t?void 0:t.name].filter((function(e){return(null===e||void 0===e?void 0:e.length)>=1})).join(G.sep);null===u||void 0===u||u((function(n){return K(K({},n),{},(0,o.Z)({},i,e.loaded/e.total))}))}})),s=(0,r.Z)(d,1)[0],f=(0,l.useCallback)((function(e){e.forEach((function(e){var n=e.name,r=e.path,i=[t],l=r.split(G.sep).filter((function(e){return e&&e!==n})).join(G.sep);l&&i.push(l);var c=[],d=i.join(G.sep);(null===d||void 0===d?void 0:d.length)>=1&&i.push(d),c.push(n);var f=c.join(G.sep);s({dir_path:d,file:e,overwrite:!1}).then((function(e){var n=e.data,t=n.error,r=n.file;a((function(e){return K(K({},e),{},(0,o.Z)({},f,r||t))}))})),u((function(e){return K(K({},e),{},(0,o.Z)({},f,0))}))}))}),[s,t,u,a]);return(0,D.jsx)(H,{onDragActiveChange:i,setFiles:f,children:n})},V=t(35185),ee=t(75499),ne=t(44897),te=t(42631),oe=(j.iI,u.default.div.withConfig({displayName:"indexstyle__DropZoneStyle",componentId:"sc-1g3zz7z-0"})(["border-radius:","px;padding:","px;max-width:","px;min-width:","px;",""],te.n_,8*j.iI,100*j.iI,55*j.iI,(function(e){return"\n    border: 1px dashed ".concat((e.theme.borders||ne.Z.borders).contrast,";\n  ")}))),re=u.default.div.withConfig({displayName:"indexstyle__TableStyle",componentId:"sc-1g3zz7z-1"})(["max-width:","px;min-width:","px;"],100*j.iI,55*j.iI);var ie=function(e){var n=e.fetchFileTree,t=e.onCancel,o=e.selectedFolder,i=(0,l.useState)(!1),u=i[0],c=i[1],a=(0,l.useState)({}),d=a[0],s=a[1],f=(0,l.useState)({}),v=f[0],h=f[1],m=!(0,M.Qr)(d),b=(0,l.useMemo)((function(){var e=[];return(0,x.YC)(Object.entries(d),(function(e){var n=(0,r.Z)(e,2),t=n[0];n[1];return t})).forEach((function(n){var t=(0,r.Z)(n,2),o=t[0],i=t[1],l=v[o],u=null===l||void 0===l?void 0:l.message;e.push([(0,D.jsxs)("div",{children:[(0,D.jsx)(p.ZP,{overflowWrap:!0,preWrap:!0,children:o}),u&&(0,D.jsx)(L.Z,{mt:1,children:(0,D.jsx)(p.ZP,{danger:!0,small:!0,children:u})})]},"name-".concat(o)),(0,D.jsx)(V.Z,{danger:!!u,progress:100*i},"progress-".concat(o))])})),(0,D.jsx)(ee.Z,{columnFlex:[1,4],columns:[{uuid:"Filename"},{uuid:"Upload progress"}],rows:e,uuid:"block-runs"})}),[d,v]);return(0,D.jsxs)(R.Z,{footer:(0,D.jsxs)(I.ZP,{fullWidth:!0,children:[(0,D.jsx)(_.ZP,{onClick:function(){return t()},children:"Close"}),m&&(0,D.jsx)(L.Z,{ml:1,children:(0,D.jsx)(_.ZP,{onClick:function(){s({}),h({})},children:"Clear files and retry"})})]}),headerTitle:"Upload files",children:[m&&(0,D.jsx)(re,{children:b}),!m&&(0,D.jsx)(J,{directoryPath:o?(0,k.jN)(o):"",onDragActiveChange:c,setFileUploadProgress:s,setUploadedFiles:function(e){h(e),null===n||void 0===n||n()},children:(0,D.jsx)(oe,{children:(0,D.jsxs)(p.ZP,{center:!0,children:[u&&"Drop to upload",!u&&"Click or drop files and folders to upload"]})})})]})},le=t(19698),ue=t(31353),ce=t(80330),ae=t(85202),de=t(44952),se=t(89538),fe=["addNewBlock","blocks","deleteWidget","fetchAutocompleteItems","fetchFileTree","fetchPipeline","files","onCreateFile","pipeline","setErrors","setSelectedBlock","widgets"];function ve(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function pe(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ve(Object(t),!0).forEach((function(n){(0,o.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ve(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var he,me=20*j.iI;function be(e,n){var t=e.addNewBlock,o=e.blocks,s=void 0===o?[]:o,v=e.deleteWidget,h=e.fetchAutocompleteItems,m=e.fetchFileTree,y=e.fetchPipeline,C=e.files,w=e.onCreateFile,O=e.pipeline,E=e.setErrors,Z=e.setSelectedBlock,P=e.widgets,_=void 0===P?[]:P,I=(0,i.Z)(e,fe),S=(0,l.useRef)(null),R=(0,l.useContext)(u.ThemeContext),L=(0,l.useState)(null),T=L[0],M=L[1],G=(0,l.useState)(null),Y=G[0],$=G[1],q=(0,l.useState)(null),W=q[0],H=q[1],X=(0,le.Z)().status,K=(0,c.Db)((function(e){return N.ZP.downloads.files.useCreate(e)()}),{onSuccess:function(e){return(0,A.wD)(e,{callback:function(){var n=e.data.download.token;(0,de.K)(n)},onErrorCallback:function(e,n){return E({errors:n,response:e})}})}}),J=(0,r.Z)(K,1)[0],V=(0,c.Db)((function(e){return N.ZP.files.useDelete(e)()}),{onSuccess:function(e){return(0,A.wD)(e,{callback:function(){null===m||void 0===m||m()},onErrorCallback:function(e,n){return E({errors:n,response:e})}})}}),ee=(0,r.Z)(V,1)[0],ne=(0,c.Db)((function(e){return N.ZP.folders.useDelete(e)()}),{onSuccess:function(e){return(0,A.wD)(e,{callback:function(){null===m||void 0===m||m()},onErrorCallback:function(e,n){return E({errors:n,response:e})}})}}),te=(0,r.Z)(ne,1)[0],oe=(0,se.dd)((function(e){var n=e.block;return(0,D.jsx)(z.Z,{centerOnScreen:!0,danger:!0,onCancel:he,onClick:function(){return ge({block:n,force:!0}).then((function(){return he()}))},subtitle:"Deleting this block file is dangerous. This block may have dependencies in active pipelines. Press confirm to delete this block anyway and remove it as a dependency from downstream blocks.",title:"Delete ".concat(n.uuid," anyway?"),width:34*j.iI})})),re=(0,r.Z)(oe,2),ve=re[0],he=re[1],be=(0,c.Db)((function(e){var n=e.block,t=n.language,o=n.type,r=n.uuid,i=e.force,l=void 0!==i&&i,u="".concat(o,"/").concat(r);return t&&f.JD[t]&&(u="".concat(u,".").concat(f.JD[t].toLowerCase())),N.ZP.blocks.useDelete(encodeURIComponent(u),{force:l})()}),{onSuccess:function(e){return(0,A.wD)(e,{callback:function(){h(),y(),m()},onErrorCallback:function(e){var n=e.error,t=n.exception;n.message.includes("raise HasDownstreamDependencies")&&ve({block:Oe,exception:t})}})}}),ge=(0,r.Z)(be,1)[0],je=(0,x.sE)(null===O||void 0===O?void 0:O.blocks,(function(e){var n=e.type;return a.tf.DATA_EXPORTER===n})),ye=(0,c.Db)(N.ZP.blocks.pipelines.useUpdate(null===O||void 0===O?void 0:O.uuid,null===je||void 0===je?void 0:je.uuid),{onSuccess:function(e){return(0,A.wD)(e,{callback:function(){null===y||void 0===y||y()},onErrorCallback:function(e,n){return E({errors:n,response:e})}})}}),Ce=(0,r.Z)(ye,1)[0],we=(0,l.useCallback)((function(){return H(null)}),[H]);(0,l.useEffect)((function(){var e,o,r,i=function(e){if(clearTimeout(S.current),$(null),Y&&O&&t){var o,r,i=(null===n||void 0===n||null===(o=n.current)||void 0===o||null===(r=o.getBoundingClientRect)||void 0===r?void 0:r.call(o))||{},l=i.width,u=i.x;if(e.pageX>u+l){var c=(null===O||void 0===O?void 0:O.type)===Q.qL.INTEGRATION,a=(0,ce.TU)(pe(pe({},Y),{},{path:(0,k.jN)(Y)}),X.repo_path,O);null===t||void 0===t||t(pe(pe({},a),{},{require_unique_name:!1}),(function(e){c&&je&&Ce({block:pe(pe({},je),{},{upstream_blocks:[e.uuid]})}),null===Z||void 0===Z||Z(e)}))}}},l=function(e){Y&&M({x:e.pageX,y:e.pageY})};return null===(e=document)||void 0===e||e.addEventListener("click",we),null===(o=document)||void 0===o||o.addEventListener("mousemove",l),null===(r=document)||void 0===r||r.addEventListener("mouseup",i),function(){var e,n,t;null===(e=document)||void 0===e||e.removeEventListener("click",we),null===(n=document)||void 0===n||n.removeEventListener("mousemove",l),null===(t=document)||void 0===t||t.removeEventListener("mouseup",i)}}),[t,je,Y,we,O,n,Z,X,S,Ce]);var ke=(0,l.useMemo)((function(){return s.concat(_).map((function(e){return e.uuid}))}),[s,_]),xe=(0,l.useMemo)((function(){return null===C||void 0===C?void 0:C.map((function(e){return(0,l.createElement)(F,pe(pe({},I),{},{containerRef:n,file:e,key:e.name,level:0,pipelineBlockUuids:ke,setCoordinates:M,setDraggingFile:$,setSelectedFile:H,theme:R,timeout:S}))}))}),[C,ke,I,n,R,S]),Oe=(0,l.useMemo)((function(){return W&&(0,k.lr)(W)}),[W]),De=(0,l.useMemo)((function(){return Y&&(0,k.lr)(Y)}),[Y]),Ee=(0,l.useMemo)((function(){return W&&"undefined"!==typeof(null===W||void 0===W?void 0:W.children)&&W}),[W]),Ze=(0,se.dd)((function(){return(0,D.jsx)(ie,{fetchFileTree:m,onCancel:_e,selectedFolder:Ee})}),{},[m,Ee],{background:!0,uuid:"upload_files"}),Pe=(0,r.Z)(Ze,2),Fe=Pe[0],_e=Pe[1],Ie=(0,se.dd)((function(e){return(0,D.jsx)(U,{fetchFileTree:m,file:null===e||void 0===e?void 0:e.file,moveFile:null===e||void 0===e?void 0:e.moveFile,onCancel:Le,onCreateFile:w,selectedFolder:Ee,setErrors:E})}),{},[m,w,Ee,E],{background:!0,disableClickOutside:!0,uuid:"new_file"}),Se=(0,r.Z)(Ie,2),Re=Se[0],Le=Se[1],Te=(0,se.dd)((function(e){return(0,D.jsx)(B,{fetchFileTree:m,file:null===e||void 0===e?void 0:e.file,moveFile:null===e||void 0===e?void 0:e.moveFile,onCancel:Ae,selectedFolder:Ee,setErrors:E})}),{},[m,Ee,E],{background:!0,disableClickOutside:!0,uuid:"new_folder"}),Ne=(0,r.Z)(Te,2),Me=Ne[0],Ae=Ne[1],Ue=(0,l.useMemo)((function(){var e;if(!Oe&&!W&&!Ee)return(0,D.jsx)("div",{});var t=(null===n||void 0===n||null===(e=n.current)||void 0===e?void 0:e.getBoundingClientRect())||{},o=t.x,r=t.width,i=T||{},l=i.x,u=void 0===l?0:l,c=i.y,s=void 0===c?0:c,f=u+j.iI;u+me>=o+r&&(f=o+r-(me+j.iI)),f<0&&(f=0);var p=[];Ee?p.push.apply(p,[{label:function(){return"New folder"},onClick:function(){Me()},uuid:"new_folder"},{label:function(){return"Rename folder"},onClick:function(){Me({file:Ee})},uuid:"rename_folder"},{label:function(){return"Move folder"},onClick:function(){Me({file:Ee,moveFile:!0})},uuid:"Move_folder"},{label:function(){return"Delete folder"},onClick:function(){var e=(0,k.jN)(Ee);window.confirm("Are you sure you want to delete folder ".concat(e," and all its subfolders and files?"))&&te(encodeURIComponent(e))},uuid:"Delete_folder"},{label:function(){return"New file"},onClick:function(){Re({file:{}})},uuid:"new_file"},{label:function(){return"Upload files"},onClick:function(){Fe()},uuid:"upload_files"},{label:function(){return"Expand all subfolders"},onClick:function(){var e=new CustomEvent(b,{detail:{collapsed:!1,file:W,folder:Ee}});window.dispatchEvent(e)},uuid:"Expand all subfolders"},{label:function(){return"Collapse all subfolders"},onClick:function(){var e=new CustomEvent(b,{detail:{collapsed:!0,file:W,folder:Ee}});window.dispatchEvent(e)},uuid:"Collapse all subfolders"}]):W&&(p.push.apply(p,[{label:function(){return"Rename file"},onClick:function(){Re({file:W})},uuid:"rename_file"},{label:function(){return"Move file"},onClick:function(){Re({file:W,moveFile:!0})},uuid:"move_file"},{label:function(){return"Download file"},onClick:function(){var e=(0,k.jN)(W);J(encodeURIComponent(e))},uuid:"download_file"}]),Oe?p.push({label:function(){return"Delete block file"},onClick:function(){Oe.type===a.tf.CHART?window.confirm("Are you sure you want to delete widget ".concat(Oe.uuid,"?"))&&v(Oe):window.confirm("Are you sure you want to delete block ".concat(Oe.uuid,"?"))&&ge({block:Oe})},uuid:"delete_block_file"}):p.push({label:function(){return"Delete file"},onClick:function(){var e=(0,k.jN)(W);window.confirm("Are you sure you want to delete file ".concat(e,"?"))&&ee(encodeURIComponent(e))},uuid:"delete_file"}));var h=s+j.iI/2,m=36*p.length;return s+m>=window.innerHeight&&(h=s-m),(0,ae.createPortal)((0,D.jsx)("div",{style:{left:f,position:"fixed",top:h,zIndex:ue.bf+100},children:(0,D.jsx)(d.Z,{items:p,open:!0,parentRef:void 0,uuid:"FileBrowser/ContextMenu",width:me})}),document.body)}),[T,ge,ee,te,v,J,n,Fe,Re,Me,Oe,W,Ee]);return(0,D.jsxs)(g.Nk,{ref:n,children:[xe,(Oe||W||Ee)&&Ue,De&&(0,D.jsx)("div",{style:{left:(null===T||void 0===T?void 0:T.x)-j.iI,position:"fixed",top:(null===T||void 0===T?void 0:T.y)-j.iI,zIndex:ue.bf+100},children:(0,D.jsx)(p.ZP,{cursor:"grabbing",monospace:!0,children:null===De||void 0===De?void 0:De.uuid})})]})}!function(e){e.BLOCK_FILE="block_file",e.DISABLED="disabled",e.FILE="file",e.FOLDER="folder",e.PIPELINE="pipeline"}(he||(he={}));var ge=l.forwardRef(be)},53005:function(e,n,t){t.d(n,{IO:function(){return h},V3:function(){return p},a9:function(){return c},jN:function(){return d},lr:function(){return v},o$:function(){return f},u$:function(){return m},y:function(){return s}});var o=t(17717),r=t(44425),i=t(89706),l=t(81728),u=t(80330);function c(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=n||(t?null:null===e||void 0===e?void 0:e.name);if(null!==e&&void 0!==e&&e.parent){var i=[e.parent.name];return(null===r||void 0===r?void 0:r.length)>=1&&i.push(r),c(e.parent,i.join(o.sep))}return r}function a(e){return null===e||void 0===e?void 0:e.split(o.sep).slice(1).join(o.sep)}function d(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=c(e,n,t);return a(o)}function s(e){var n=["\\.".concat(i.Lu.PY),"\\.".concat(i.Lu.R),"\\.".concat(i.Lu.SQL),"\\.".concat(i.Lu.YAML),"\\.".concat(i.Lu.YML)].join("|"),t=new RegExp("".concat(n,"$")),o=e.match(t);return(null===o||void 0===o?void 0:o.length)>=1?o[0].replace(".",""):null}function f(e,n){var t=s(e);return!["__init__.py"].includes(e)&&(r.tf.DBT!==n||![i.Lu.YAML,i.Lu.YML].includes(t))}function v(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=c(e,n).split(o.sep);if(!l)return null;var a=(0,u.ck)(l);if(!l)return null;var d="";d=l.length>=3?l.slice(2,l.length).join(o.sep):l[l.length-1];var f=t?r.Q3:r.$W;if(f.concat(r.tf.DBT).includes(a)&&s(d)){var v=d.lastIndexOf("."),p=d.slice(v+1);return{language:i.nB[p],type:a,uuid:d.slice(0,v)}}}function p(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=c(e,n).split(o.sep);if(t[1]){var u=(0,l.C5)(t[n?0:1]);t[1]===r.tf.DBT&&(u=r.tf.DBT);var a=t[t.length-1],d=new RegExp(".".concat(i.Lu.YAML,"$")),s=new RegExp(".".concat(i.Lu.R,"$")),f=new RegExp(".".concat(i.Lu.SQL,"$")),v=new RegExp(".".concat(i.Lu.MD,"$"));if(a.match(d)&&r.VZ.includes(u))return{type:u,uuid:a.replace(d,"")};if(a.match(s)&&r.J8.includes(u))return{type:u,uuid:a.replace(s,"")};if(a.match(f)&&r.HX.includes(u)){var p=a.replace(/[.]/g,"_"),h=u===r.tf.DBT?t.slice(2,-1).join("_").concat("_".concat(p)):a.replace(f,"");return{type:u,uuid:h}}return a.match(v)&&u===r.tf.MARKDOWN?{type:u,uuid:a.replace(v,"")}:void 0}}function h(e,n){var t=e.split("."),r=t[t.length-1];i.n6.includes(r)&&t.pop();var l=t.join("").split(o.sep),u=l.slice(1,l.length).join("");return n.find((function(e){return e.uuid===u}))}function m(e){var n=e||{},t=n.language,o=n.name,u=n.type;if(o&&t&&u){var c=u===r.tf.CUSTOM?u:"".concat(u,"s"),a=i.JD[t],d=(0,l.kE)(o);return"".concat(c,"/").concat(d,".").concat(a)}}},80330:function(e,n,t){t.d(n,{TU:function(){return p},lU:function(){return v},ck:function(){return f}});var o=t(21831),r=t(17717),i=t(44425),l=t(57653),u=t(89706),c=t(86735);function a(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=n||(t?null:null===e||void 0===e?void 0:e.name);if(null!==e&&void 0!==e&&e.parent){var i=[e.parent.name];return(null===o||void 0===o?void 0:o.length)>=1&&i.push(o),a(e.parent,i.join(r.sep))}return o}var d=t(81728),s=t(42122),f=function(e){var n;if(null===e||void 0===e||e.forEach((function(e){if((null===e||void 0===e?void 0:e.length)>=1){var t=null===e||void 0===e?void 0:e.toLowerCase();(t in i.qC||(t=(0,d.C5)(t))in i.GJ)&&(n=t)}})),!n){var t=["\\.".concat(u.Lu.SQL),"\\.".concat(u.Lu.YAML),"\\.".concat(u.Lu.YML)].join("|"),o=new RegExp("".concat(t,"$"));if(e.join(r.sep).match(o))return i.tf.DBT}return n};function v(){return new RegExp(Object.keys(u.nB).map((function(e){return".(".concat(e,")$")})).join("|"))}function p(e,n,t){var p,h,m=null===e||void 0===e||null===(p=e.path.match(v())[0])||void 0===p?void 0:p.split(".")[1],b=t.type===l.qL.INTEGRATION,g=(0,c.sE)(null===t||void 0===t?void 0:t.blocks,(function(e){var n=e.type;return i.tf.DATA_EXPORTER===n})),j=e.path.replace(n,"").split(r.sep),y=f(e.path.split(r.sep)),C=i.tf.DBT===y,w=(h=j)[0]===i.tf.DBT?h.slice(1).join(r.sep):function(e){return e.at(-1)}(h).split(".")[0];if(j.length>=3&&!C){var k=j.slice(1,j.length-1).join(r.sep);w="".concat(k,"/").concat(w)}var x=u.nB[m],O={configuration:(0,s.hB)({file_path:C&&i.t6.SQL===x?w:null,file_source:{path:a(e)}}),language:x,name:(0,d.wE)(w),type:y};if(y===i.tf.CUSTOM&&(O.color=i.Lq.TEAL),b){var D=(0,c.sE)(t.blocks,(function(e){var n=e.type;return i.tf.DATA_LOADER===n})),E=(0,c.sE)(t.blocks,(function(e){var n=e.type;return i.tf.TRANSFORMER===n})),Z=[];E?Z.push(E.uuid):null!==g&&void 0!==g&&g.upstream_blocks?Z.push.apply(Z,(0,o.Z)(g.upstream_blocks)):D&&Z.push(D.uuid),O.upstream_blocks=Z}return O}},44952:function(e,n,t){t.d(n,{K:function(){return r}});var o=t(4383);function r(e){var n=(0,o.ZP)("downloads",e),t=document.createElement("a");t.href=n,document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(n),document.body.removeChild(t)}},19698:function(e,n,t){var o=t(82684),r=t(35686);n.Z=function(){var e=r.ZP.statuses.list().data;return{status:(0,o.useMemo)((function(){var n;return null===e||void 0===e||null===(n=e.statuses)||void 0===n?void 0:n[0]}),[e])}}}}]);